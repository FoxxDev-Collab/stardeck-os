(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[29],{20120:(e,s,t)=>{"use strict";t.d(s,{$v:()=>p,EO:()=>m,Lt:()=>c,Rx:()=>j,Zr:()=>f,ck:()=>u,r7:()=>h,tv:()=>i,wd:()=>x});var a=t(95155);t(12115);var r=t(52498),n=t(25016),l=t(97003);function c(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"alert-dialog",...s})}function i(e){let{...s}=e;return(0,a.jsx)(r.l9,{"data-slot":"alert-dialog-trigger",...s})}function d(e){let{...s}=e;return(0,a.jsx)(r.ZL,{"data-slot":"alert-dialog-portal",...s})}function o(e){let{className:s,...t}=e;return(0,a.jsx)(r.hJ,{"data-slot":"alert-dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function m(e){let{className:s,...t}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(o,{}),(0,a.jsx)(r.UC,{"data-slot":"alert-dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function x(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function u(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(r.hE,{"data-slot":"alert-dialog-title",className:(0,n.cn)("text-lg font-semibold",s),...t})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(r.VY,{"data-slot":"alert-dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",s),...t})}function j(e){let{className:s,...t}=e;return(0,a.jsx)(r.rc,{className:(0,n.cn)((0,l.r)(),s),...t})}function f(e){let{className:s,...t}=e;return(0,a.jsx)(r.ZD,{className:(0,n.cn)((0,l.r)({variant:"outline"}),s),...t})}},23327:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},30426:(e,s,t)=>{Promise.resolve().then(t.bind(t,48274))},31929:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("memory-stick",[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]])},35626:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},46046:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},48274:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ec});var a=t(95155),r=t(12115),n=t(20063),l=t(6707),c=t(22312),i=t(97003),d=t(83209),o=t(90923),m=t(33789),x=t(90235),u=t(7235),h=t(67812),p=t(35299),j=t(6132),f=t(35626),g=t(16140),N=t(59e3),v=t(93141),b=t(85921),w=t(39068),y=t(71360),k=t(23327),A=t(50906),C=t(50803),S=t(89715),_=t(71847);let R=(0,_.A)("circle-arrow-up",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);var M=t(15870),E=t(14639),B=t(95707),F=t(20523),L=t(46046),z=t(55850);let D=(0,_.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),U=(0,_.A)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),I=(0,_.A)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var O=t(31929);function P(e){let{containerId:s,isRunning:t}=e,{token:n}=(0,l.A)(),[c,i]=(0,r.useState)({cpu:[],memory:[]}),[o,m]=(0,r.useState)(null),[x,u]=(0,r.useState)(null),[f,g]=(0,r.useState)(!0),[N,v]=(0,r.useState)(null),b=(0,r.useCallback)(async()=>{if(n&&s&&t)try{let e=await fetch("/api/containers/".concat(s,"/stats"),{headers:{Authorization:"Bearer ".concat(n)}});if(!e.ok)throw Error("Failed to fetch stats");let t=await e.json();m(e=>(u(e),t)),v(null),i(e=>({cpu:[...e.cpu,t.cpu_percent].slice(-30),memory:[...e.memory,t.memory_percent].slice(-30)})),g(!1)}catch(e){v(e instanceof Error?e.message:"Failed to fetch stats"),g(!1)}},[n,s,t]);(0,r.useEffect)(()=>{if(!t){i({cpu:[],memory:[]}),m(null),u(null),g(!1);return}b();let e=setInterval(b,3e3);return()=>clearInterval(e)},[t,b]);let w=e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]},y=(e,s)=>{if(void 0===s)return"stable";let t=e-s;return .5>Math.abs(t)?"stable":t>0?"up":"down"},k=e=>{let{trend:s}=e;switch(s){case"up":return(0,a.jsx)(D,{className:"w-3 h-3 text-red-500"});case"down":return(0,a.jsx)(U,{className:"w-3 h-3 text-green-500"});default:return(0,a.jsx)(I,{className:"w-3 h-3 text-muted-foreground"})}},C=e=>{let{data:s,color:t="#06b6d4"}=e;if(s.length<2)return null;let r=Math.max(...s,1),n=Math.min(...s,0),l=r-n||1,c=s.map((e,t)=>{let a=t/(s.length-1)*120;return"".concat(a,",").concat(24-(e-n)/l*24)}).join(" ");return(0,a.jsx)("svg",{width:120,height:24,className:"opacity-60",children:(0,a.jsx)("polyline",{fill:"none",stroke:t,strokeWidth:"1.5",points:c})})};if(!t)return(0,a.jsx)(d.Zp,{className:"bg-card/50 border-border/50",children:(0,a.jsxs)(d.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(A.A,{className:"w-12 h-12 text-muted-foreground/50 mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Container is not running"})]})});if(f&&!o)return(0,a.jsx)(d.Zp,{className:"bg-card/50 border-border/50",children:(0,a.jsx)(d.Wu,{className:"flex items-center justify-center py-12",children:(0,a.jsx)(p.A,{className:"w-8 h-8 animate-spin text-accent"})})});if(N)return(0,a.jsx)(d.Zp,{className:"bg-card/50 border-border/50",children:(0,a.jsxs)(d.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(j.A,{className:"w-12 h-12 text-destructive mb-4"}),(0,a.jsx)("p",{className:"text-destructive",children:N})]})});if(!o)return null;let S=y(o.cpu_percent,null==x?void 0:x.cpu_percent),_=y(o.memory_percent,null==x?void 0:x.memory_percent);return(0,a.jsxs)(d.Zp,{className:"bg-card/50 border-border/50",children:[(0,a.jsxs)(d.aR,{className:"pb-3",children:[(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(A.A,{className:"w-5 h-5 text-accent"}),"Real-time Performance"]}),(0,a.jsx)(d.BT,{children:"Live container resource usage"})]}),(0,a.jsxs)(d.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500/20 to-blue-500/20 border border-cyan-500/30 flex items-center justify-center",children:(0,a.jsx)(B.A,{className:"w-4 h-4 text-cyan-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"CPU Usage"}),(0,a.jsx)(k,{trend:S})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-cyan-400",children:[o.cpu_percent.toFixed(1),"%"]})]})]}),c.cpu.length>1&&(0,a.jsx)(C,{data:c.cpu,color:"#06b6d4"})]}),(0,a.jsx)(z.k,{value:Math.min(o.cpu_percent,100),className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500/20 to-pink-500/20 border border-purple-500/30 flex items-center justify-center",children:(0,a.jsx)(O.A,{className:"w-4 h-4 text-purple-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Memory Usage"}),(0,a.jsx)(k,{trend:_})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-400",children:[o.memory_percent.toFixed(1),"%"]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[w(o.memory_used)," / ",w(o.memory_limit)]})]})]}),c.memory.length>1&&(0,a.jsx)(C,{data:c.memory,color:"#a855f7"})]}),(0,a.jsx)(z.k,{value:Math.min(o.memory_percent,100),className:"h-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-border/50",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-green-500/20 to-emerald-500/20 border border-green-500/30 flex items-center justify-center",children:(0,a.jsx)(E.A,{className:"w-4 h-4 text-green-400"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Network I/O"})]}),(0,a.jsxs)("div",{className:"space-y-2 pl-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)("span",{className:"text-green-500",children:"↓"}),(0,a.jsx)("span",{children:"Received"})]}),(0,a.jsx)("span",{className:"font-mono text-green-400",children:w(o.network_rx)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)("span",{className:"text-blue-500",children:"↑"}),(0,a.jsx)("span",{children:"Transmitted"})]}),(0,a.jsx)("span",{className:"font-mono text-blue-400",children:w(o.network_tx)})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-amber-500/20 to-orange-500/20 border border-amber-500/30 flex items-center justify-center",children:(0,a.jsx)(F.A,{className:"w-4 h-4 text-amber-400"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Disk I/O"})]}),(0,a.jsxs)("div",{className:"space-y-2 pl-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)("span",{className:"text-amber-500",children:"R"}),(0,a.jsx)("span",{children:"Read"})]}),(0,a.jsx)("span",{className:"font-mono text-amber-400",children:w(o.block_read)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)("span",{className:"text-orange-500",children:"W"}),(0,a.jsx)("span",{children:"Write"})]}),(0,a.jsx)("span",{className:"font-mono text-orange-400",children:w(o.block_write)})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-border/50",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Active Processes"}),(0,a.jsxs)(h.E,{variant:"outline",className:"font-mono",children:[o.pids," PIDs"]})]})]})]})}function $(e){let{containerId:s,containerName:t}=e,{token:n}=(0,l.A)(),c=(0,r.useRef)(null),[d,o]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),[j,f]=(0,r.useState)([]),[g,N]=(0,r.useState)(""),b=(0,r.useRef)(null),w=(0,r.useRef)(null),k=()=>{if(!s||!n||c.current)return;x(!0),p(null);let e="https:"===window.location.protocol?"wss:":"ws:",t=new WebSocket("".concat(e,"//").concat(window.location.host,"/api/containers/").concat(s,"/exec"));c.current=t,t.onopen=()=>{var e;x(!1),o(!0),p(null),t.send(JSON.stringify({type:"auth",token:n})),null==(e=w.current)||e.focus()},t.onmessage=e=>{try{let s=JSON.parse(e.data);"output"===s.type?f(e=>[...e,s.data]):"error"===s.type?p(s.message):"auth"===s.type&&s.success&&f(e=>[...e,"Shell session started. Type commands below.\n"])}catch(s){f(s=>[...s,e.data])}},t.onerror=()=>{p("WebSocket connection error"),x(!1),o(!1)},t.onclose=()=>{x(!1),o(!1),c.current=null}},A=()=>{c.current&&(c.current.close(),c.current=null),o(!1)};(0,r.useEffect)(()=>(k(),()=>{A()}),[s,n]),(0,r.useEffect)(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[j]);let S=()=>{A(),f([]),setTimeout(k,100)};return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-black/90 rounded-lg overflow-hidden border border-border/30",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-border/30 flex items-center justify-between bg-card/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-green-500/20 to-emerald-500/20 border border-green-500/30 flex items-center justify-center",children:(0,a.jsx)(C.A,{className:"w-4 h-4 text-green-400"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Container Shell"}),t&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t})]}),m?(0,a.jsx)(h.E,{variant:"outline",className:"bg-yellow-500/10 text-yellow-500 border-yellow-500/30",children:"Connecting..."}):d?(0,a.jsx)(h.E,{variant:"outline",className:"bg-green-500/10 text-green-500 border-green-500/30",children:"Connected"}):(0,a.jsx)(h.E,{variant:"outline",className:"bg-red-500/10 text-red-500 border-red-500/30",children:"Disconnected"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>{f([])},className:"h-8",title:"Clear output",children:(0,a.jsx)(y.A,{className:"w-4 h-4"})}),(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:S,className:"h-8",title:"Reconnect",children:(0,a.jsx)(v.A,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{ref:b,className:"flex-1 overflow-y-auto p-4 font-mono text-sm text-green-400 space-y-0 min-h-0",onClick:()=>{var e;return null==(e=w.current)?void 0:e.focus()},children:[u&&(0,a.jsx)("div",{className:"text-red-500 mb-4 p-2 bg-red-500/10 rounded border border-red-500/30",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:u}),(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:S,className:"h-6 text-xs",children:"Reconnect"})]})}),0===j.length&&!u&&(0,a.jsx)("div",{className:"text-muted-foreground",children:m?"Connecting to container...":d?"Connected. Type a command...":"Click Reconnect to start a shell session."}),j.map((e,s)=>(0,a.jsx)("div",{className:"whitespace-pre-wrap break-all leading-relaxed",children:e},s))]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),g.trim()&&c.current&&c.current.readyState===WebSocket.OPEN&&(c.current.send(JSON.stringify({type:"input",data:g+"\n"})),f(e=>[...e,"$ ".concat(g,"\n")]),N(""))},className:"border-t border-border/30 p-3 flex items-center gap-2 bg-black/50",children:[(0,a.jsx)("span",{className:"text-green-400 font-mono",children:"$"}),(0,a.jsx)("input",{ref:w,type:"text",value:g,onChange:e=>N(e.target.value),placeholder:d?"Enter command...":"Not connected",disabled:!d,className:"flex-1 bg-transparent border-none outline-none text-green-400 font-mono placeholder:text-green-400/30 disabled:opacity-50",autoFocus:!0}),(0,a.jsx)(i.$,{type:"submit",size:"sm",disabled:!d||!g.trim(),className:"bg-green-500/20 hover:bg-green-500/30 text-green-400 border border-green-500/30",children:"Send"})]})]})}var Z=t(47507),T=t(86651),W=t(53511),J=t(5917),H=t(75426),V=t(39867);function G(e){let{containerId:s,containerName:t}=e,{token:n}=(0,l.A)(),[c,d]=(0,r.useState)([]),[o,j]=(0,r.useState)([]),[f,g]=(0,r.useState)(""),[N,w]=(0,r.useState)(!0),[y,k]=(0,r.useState)(!1),[A,C]=(0,r.useState)("100"),[_,R]=(0,r.useState)(!0),[M,E]=(0,r.useState)(!1),[B,F]=(0,r.useState)(!0),[L,z]=(0,r.useState)(null),D=(0,r.useRef)(null),U=(0,r.useRef)(null),I=(0,r.useCallback)(async()=>{if(n&&s){F(!0),z(null);try{let e=new URLSearchParams({tail:A,timestamps:_.toString()}),t=await fetch("/api/containers/".concat(s,"/logs?").concat(e),{headers:{Authorization:"Bearer ".concat(n)}});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to fetch logs")}let a=await t.json();d(a.logs||[])}catch(e){z(e instanceof Error?e.message:"Failed to fetch logs"),console.error("Failed to fetch logs:",e)}finally{F(!1)}}},[n,s,A,_]),O=(0,r.useCallback)(()=>{if(!s||!n)return;let e="https:"===window.location.protocol?"wss:":"ws:",t=new WebSocket("".concat(e,"//").concat(window.location.host,"/api/containers/").concat(s,"/logs/stream"));U.current=t,t.onopen=()=>{t.send(JSON.stringify({type:"auth",token:n})),k(!0)},t.onmessage=e=>{try{let s=JSON.parse(e.data);("log"===s.type||s.line)&&d(t=>[...t,s.line||s.message||e.data])}catch(s){d(s=>[...s,e.data])}},t.onerror=()=>{k(!1)},t.onclose=()=>{k(!1),U.current=null}},[s,n]),P=(0,r.useCallback)(()=>{U.current&&(U.current.close(),U.current=null),k(!1)},[]);(0,r.useEffect)(()=>(I(),()=>{P()}),[I,P]),(0,r.useEffect)(()=>{f.trim()?j(c.filter(e=>e.toLowerCase().includes(f.toLowerCase()))):j(c)},[c,f]),(0,r.useEffect)(()=>{N&&D.current&&(D.current.scrollTop=D.current.scrollHeight)},[o,N]);let $=()=>{P(),I()};return(0,a.jsxs)("div",{className:"h-full flex flex-col rounded-lg overflow-hidden border border-border/30",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-border/50 bg-card/50 flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500/20 to-indigo-500/20 border border-blue-500/30 flex items-center justify-center",children:(0,a.jsx)(S.A,{className:"w-4 h-4 text-blue-400"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Container Logs"}),t&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t}),(0,a.jsxs)(h.E,{variant:"outline",className:"font-mono",children:[o.length," lines"]})]})]})}),(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-border/50 bg-muted/30 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[200px] relative",children:[(0,a.jsx)(T.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(m.p,{placeholder:"Search logs...",value:f,onChange:e=>g(e.target.value),className:"pl-9"})]}),(0,a.jsxs)(Z.l6,{value:A,onValueChange:e=>{C(e)},children:[(0,a.jsx)(Z.bq,{className:"w-[140px]",children:(0,a.jsx)(Z.yv,{})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"50",children:"Last 50 lines"}),(0,a.jsx)(Z.eb,{value:"100",children:"Last 100 lines"}),(0,a.jsx)(Z.eb,{value:"500",children:"Last 500 lines"}),(0,a.jsx)(Z.eb,{value:"1000",children:"Last 1000 lines"}),(0,a.jsx)(Z.eb,{value:"all",children:"All lines"})]})]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{y?P():O()},className:y?"bg-green-500/20 border-green-500/30 text-green-500":"",children:[y?(0,a.jsx)(W.A,{className:"w-4 h-4 mr-2"}):(0,a.jsx)(b.A,{className:"w-4 h-4 mr-2"}),y?"Following":"Follow"]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:$,disabled:B,children:[B?(0,a.jsx)(p.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(o.join("\n")),E(!0),setTimeout(()=>E(!1),2e3)},children:[M?(0,a.jsx)(J.A,{className:"w-4 h-4 mr-2"}):(0,a.jsx)(H.A,{className:"w-4 h-4 mr-2"}),M?"Copied!":"Copy"]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([c.join("\n")],{type:"text/plain"}),a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download="".concat(t||s,"-logs.txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},children:[(0,a.jsx)(V.A,{className:"w-4 h-4 mr-2"}),"Download"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.d,{id:"auto-scroll",checked:N,onCheckedChange:w}),(0,a.jsx)(x.J,{htmlFor:"auto-scroll",className:"text-sm cursor-pointer",children:"Auto-scroll"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.d,{id:"timestamps",checked:_,onCheckedChange:e=>{R(e)}}),(0,a.jsx)(x.J,{htmlFor:"timestamps",className:"text-sm cursor-pointer",children:"Show timestamps"})]})]})]}),(0,a.jsx)("div",{ref:D,className:"flex-1 overflow-y-auto p-4 bg-black/90 font-mono text-xs text-gray-300 space-y-0 min-h-0",children:B&&0===c.length?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(p.A,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):L?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-red-400 mb-2",children:L}),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:$,children:"Try Again"})]}):0===o.length?(0,a.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:f?"No logs match your search":"No logs available"}):o.map((e,s)=>{let t=/error|failed|fatal/i.test(e),r=/warn|warning/i.test(e),n=/info/i.test(e),l=/debug/i.test(e),c="text-gray-300";t?c="text-red-400":r?c="text-yellow-400":n?c="text-blue-400":l&&(c="text-purple-400");let i=f?e.split(RegExp("(".concat(f,")"),"gi")):[e];return(0,a.jsxs)("div",{className:"".concat(c," whitespace-pre-wrap break-all hover:bg-white/5 px-2 py-0.5 rounded transition-colors leading-relaxed"),children:[(0,a.jsx)("span",{className:"text-muted-foreground select-none mr-2 w-8 inline-block text-right",children:s+1}),f?i.map((e,s)=>e.toLowerCase()===f.toLowerCase()?(0,a.jsx)("span",{className:"bg-yellow-500/30 text-yellow-300",children:e},s):(0,a.jsx)("span",{children:e},s)):e]},s)})})]})}var q=t(27346),X=t(54679),Y=t(20120),K=t(78874),Q=t(26617);let ee=(0,_.A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var es=t(89559),et=t(61362),ea=t(26983),er=t(58734);function en(e){var s;let{containerId:t,currentImage:n,hasVolumes:c}=e,{token:o,user:f}=(0,l.A)(),[g,N]=(0,r.useState)(!1),[v,b]=(0,r.useState)(null),[w,k]=(0,r.useState)([]),[A,C]=(0,r.useState)(!0),[S,_]=(0,r.useState)(!1),[M,E]=(0,r.useState)(!1),[B,L]=(0,r.useState)([]),[D,U]=(0,r.useState)(0),[I,O]=(0,r.useState)(!1),[P,$]=(0,r.useState)(null),[Z,T]=(0,r.useState)(!0),[W,J]=(0,r.useState)(!1),[H,G]=(0,r.useState)(""),[en,el]=(0,r.useState)(!1),[ec,ei]=(0,r.useState)(""),ed=(0,r.useRef)(null),eo=(null==f?void 0:f.role)==="admin"||(null==f?void 0:f.is_pam_admin),em=(0,r.useCallback)(async()=>{if(o&&t){C(!0);try{let e=await fetch("/api/containers/".concat(t,"/backups"),{headers:{Authorization:"Bearer ".concat(o)}});if(e.ok){let s=await e.json();k(s||[])}}catch(e){console.error("Failed to fetch backups:",e)}finally{C(!1)}}},[o,t]),ex=async()=>{if(o&&t){N(!0),b(null);try{let e=await fetch("/api/containers/".concat(t,"/check-update"),{headers:{Authorization:"Bearer ".concat(o)}});if(!e.ok)throw Error("Failed to check for updates");let s=await e.json();b(s)}catch(e){console.error("Failed to check for updates:",e)}finally{N(!1)}}},eu=async e=>{if(o)try{if(!(await fetch("/api/containers/backups/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(o)}})).ok)throw Error("Failed to delete backup");await em()}catch(e){console.error("Failed to delete backup:",e),alert(e instanceof Error?e.message:"Failed to delete backup")}};(0,r.useEffect)(()=>{em()},[em]),(0,r.useEffect)(()=>()=>{ed.current&&ed.current.close()},[]);let eh=e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(Q.A,{className:"w-4 h-4 text-cyan-400"}),"Current Image"]})}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-mono text-sm",children:n}),v&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 font-mono",children:["Digest: ",null==(s=v.local_digest)?void 0:s.substring(0,20),"..."]})]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:ex,disabled:g||!eo,children:[g?(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,a.jsx)(es.A,{className:"w-4 h-4 mr-2"}),"Check for Updates"]})]}),v&&(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat(v.has_update?"bg-amber-500/10 border-amber-500/30":"bg-green-500/10 border-green-500/30"),children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:v.has_update?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R,{className:"w-5 h-5 text-amber-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-amber-500",children:"Update Available"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"A newer version of this image is available"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(et.A,{className:"w-5 h-5 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-green-500",children:"Up to Date"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"You are running the latest version"})]})]})})}),eo&&(0,a.jsxs)(i.$,{onClick:()=>_(!0),disabled:!eo,className:"w-full",children:[(0,a.jsx)(R,{className:"w-4 h-4 mr-2"}),"Update Container"]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(ee,{className:"w-4 h-4 text-amber-400"}),"Volume Backups"]}),(0,a.jsx)(d.BT,{children:"Backups of bind mount data created before updates"})]}),(0,a.jsx)(d.Wu,{children:A?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(p.A,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):0===w.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(ee,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"No backups found"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Backups are created when you update a container with volumes"})]}):(0,a.jsx)("div",{className:"space-y-3",children:w.map(e=>(0,a.jsxs)("div",{className:"p-3 rounded-lg border border-border/50 bg-muted/30 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.E,{variant:"outline",className:"text-xs",children:e.backup_type}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.id})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(ea.A,{className:"w-3 h-3"}),new Date(e.created_at).toLocaleString()]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(F.A,{className:"w-3 h-3"}),eh(e.size_bytes)]})]})]}),eo&&(0,a.jsxs)(Y.Lt,{children:[(0,a.jsx)(Y.tv,{asChild:!0,children:(0,a.jsx)(i.$,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:(0,a.jsx)(y.A,{className:"w-4 h-4"})})}),(0,a.jsxs)(Y.EO,{children:[(0,a.jsxs)(Y.wd,{children:[(0,a.jsx)(Y.r7,{children:"Delete Backup"}),(0,a.jsx)(Y.$v,{children:"Are you sure you want to delete this backup? This action cannot be undone."})]}),(0,a.jsxs)(Y.ck,{children:[(0,a.jsx)(Y.Zr,{children:"Cancel"}),(0,a.jsx)(Y.Rx,{onClick:()=>eu(e.id),children:"Delete"})]})]})]})]}),e.mounts&&e.mounts.length>0&&(0,a.jsx)("div",{className:"pl-2 border-l-2 border-border/50 mt-2",children:e.mounts.map((e,s)=>(0,a.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(er.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{className:"font-mono truncate",title:e.source,children:e.target}),(0,a.jsxs)("span",{className:"text-muted-foreground/60",children:["(",eh(e.size_bytes),")"]})]},s))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground font-mono truncate",title:e.backup_path,children:e.backup_path})]},e.id))})})]}),(0,a.jsx)(X.lG,{open:S,onOpenChange:e=>!M&&_(e),children:(0,a.jsxs)(X.Cf,{className:"max-w-lg",children:[(0,a.jsxs)(X.c7,{children:[(0,a.jsx)(X.L3,{children:"Update Container"}),(0,a.jsx)(X.rr,{children:"Pull the latest image and recreate the container with the same configuration"})]}),M||I?(0,a.jsxs)("div",{className:"py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"Progress"}),(0,a.jsxs)("span",{children:[D,"%"]})]}),(0,a.jsx)(z.k,{value:D,className:"h-2"})]}),(0,a.jsx)(q.F,{className:"h-64 rounded-lg border border-border/50 bg-muted/30",children:(0,a.jsxs)("div",{className:"p-3 space-y-2",children:[B.map((e,s)=>{var t;return(0,a.jsxs)("div",{className:"flex items-start gap-2 text-sm ".concat(e.error?"text-destructive":""),children:[((e,s)=>{if(s)return(0,a.jsx)(K.A,{className:"w-4 h-4 text-destructive"});switch(e){case"config":return(0,a.jsx)(Q.A,{className:"w-4 h-4 text-blue-400"});case"backup":return(0,a.jsx)(ee,{className:"w-4 h-4 text-amber-400"});case"pull":return(0,a.jsx)(V.A,{className:"w-4 h-4 text-cyan-400"});case"stop":return(0,a.jsx)(j.A,{className:"w-4 h-4 text-orange-400"});case"rename":return(0,a.jsx)(es.A,{className:"w-4 h-4 text-purple-400"});case"create":return(0,a.jsx)(Q.A,{className:"w-4 h-4 text-green-400"});case"start":return(0,a.jsx)(R,{className:"w-4 h-4 text-green-400"});case"cleanup":return(0,a.jsx)(y.A,{className:"w-4 h-4 text-gray-400"});case"complete":return(0,a.jsx)(et.A,{className:"w-4 h-4 text-green-500"});default:return(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin"})}})(e.step,e.error),(0,a.jsx)("span",{className:(null==(t=e.details)?void 0:t.output)?"font-mono text-xs text-muted-foreground":"",children:e.message})]},s)}),M&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin"}),(0,a.jsx)("span",{children:"Processing..."})]})]})}),P&&(0,a.jsxs)("div",{className:"p-3 rounded-lg border border-destructive/50 bg-destructive/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,a.jsx)(K.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium",children:"Update Failed"})]}),(0,a.jsx)("p",{className:"text-sm mt-1",children:P})]}),I&&(0,a.jsxs)("div",{className:"p-3 rounded-lg border border-green-500/50 bg-green-500/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-500",children:[(0,a.jsx)(et.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium",children:"Update Complete"})]}),(0,a.jsx)("p",{className:"text-sm mt-1 text-muted-foreground",children:"Container has been updated successfully. Refresh the page to see changes."})]}),(0,a.jsx)(X.Es,{children:M?(0,a.jsx)(i.$,{variant:"outline",onClick:()=>{ed.current&&(ed.current.close(),ed.current=null),E(!1),_(!1)},children:"Cancel"}):(0,a.jsx)(i.$,{onClick:()=>{_(!1),I&&window.location.reload()},children:I?"Close & Refresh":"Close"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"New Image (optional)"}),(0,a.jsx)(m.p,{placeholder:n,value:ec,onChange:e=>ei(e.target.value)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Leave empty to pull the latest version of the current image"})]}),c&&(0,a.jsxs)("div",{className:"space-y-3 p-3 rounded-lg border border-border/50 bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x.J,{children:"Create Backup"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Backup bind mount data before updating"})]}),(0,a.jsx)(u.d,{checked:Z,onCheckedChange:T})]}),Z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x.J,{children:"Overwrite Existing Backup"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Replace previous backup for this container"})]}),(0,a.jsx)(u.d,{checked:W,onCheckedChange:J})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Custom Backup Path (optional)"}),(0,a.jsx)(m.p,{placeholder:"~/.stardeck/backups",value:H,onChange:e=>G(e.target.value)})]})]})]}),!c&&(0,a.jsx)("div",{className:"p-3 rounded-lg border border-blue-500/30 bg-blue-500/10",children:(0,a.jsx)("p",{className:"text-sm text-blue-400",children:"This container has no bind mounts, so no backup will be created."})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x.J,{children:"Remove Old Container"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Delete the backup container after successful update"})]}),(0,a.jsx)(u.d,{checked:en,onCheckedChange:el})]})]}),(0,a.jsxs)(X.Es,{children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),(0,a.jsxs)(i.$,{onClick:()=>{if(!o||!t)return;L([]),U(0),O(!1),$(null),E(!0);let e="https:"===window.location.protocol?"wss:":"ws:",s=new WebSocket("".concat(e,"//").concat(window.location.host,"/api/containers/").concat(t,"/update?token=").concat(o));ed.current=s,s.onopen=()=>{s.send(JSON.stringify({container_id:t,new_image:ec||void 0,create_backup:Z&&c,backup_path:H||void 0,overwrite_backup:W,remove_old:en,stop_timeout:30}))},s.onmessage=e=>{try{let s=JSON.parse(e.data);L(e=>[...e,s]),s.progress&&U(s.progress),s.complete&&(O(!0),E(!1),em()),s.error&&($(s.message),E(!1))}catch(e){console.error("Failed to parse update message:",e)}},s.onerror=()=>{$("WebSocket connection failed"),E(!1)},s.onclose=()=>{ed.current=null}},children:[(0,a.jsx)(R,{className:"w-4 h-4 mr-2"}),"Start Update"]})]})]})]})})]})}function el(){var e;let{isAuthenticated:s,isLoading:t,token:_,user:z}=(0,l.A)(),D=(0,n.useRouter)(),U=(0,n.useSearchParams)().get("id"),[I,O]=(0,r.useState)(""),[Z,T]=(0,r.useState)(null),[W,J]=(0,r.useState)(null),[H,V]=(0,r.useState)(!0),[q,X]=(0,r.useState)(null),[Y,K]=(0,r.useState)("overview"),[Q,ee]=(0,r.useState)(!1),[es,et]=(0,r.useState)(!1),[ea,er]=(0,r.useState)(!1),[el,ec]=(0,r.useState)(""),[ei,ed]=(0,r.useState)("/"),[eo,em]=(0,r.useState)(""),[ex,eu]=(0,r.useState)(!1),eh=(null==z?void 0:z.role)==="admin"||(null==z?void 0:z.is_pam_admin),ep=(0,r.useCallback)(async()=>{if(_&&U)try{var e;let[s,t]=await Promise.all([fetch("/api/containers/".concat(U),{headers:{Authorization:"Bearer ".concat(_)}}),fetch("/api/containers/".concat(U,"/inspect"),{headers:{Authorization:"Bearer ".concat(_)}})]);if(!s.ok)throw Error("Container not found");let a=await s.json();if(T(a),er(a.has_web_ui||!1),ec((null==(e=a.web_ui_port)?void 0:e.toString())||""),ed(a.web_ui_path||"/"),em(a.icon||""),eu(a.auto_start||!1),t.ok){let e=await t.json();J(e)}X(null)}catch(e){X(e instanceof Error?e.message:"Failed to load container")}finally{V(!1)}},[_,U]);(0,r.useEffect)(()=>{t||s||D.push("/login")},[s,t,D]),(0,r.useEffect)(()=>{let e=()=>{O(new Date().toLocaleTimeString("en-US",{hour12:!1}))};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[]),(0,r.useEffect)(()=>{if(s&&_&&U){ep();let e=setInterval(ep,1e4);return()=>clearInterval(e)}},[s,_,U,ep]);let ej=async e=>{if(_&&U&&("remove"!==e||confirm("Are you sure you want to remove this container? This cannot be undone."))){ee(!0);try{if(!(await fetch("/api/containers/".concat(U,"/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(_)}})).ok)throw Error("Failed to ".concat(e," container"));"remove"===e?D.push("/container-manager"):await ep()}catch(s){alert(s instanceof Error?s.message:"Failed to ".concat(e," container"))}finally{ee(!1)}}},ef=async()=>{if(_&&U&&Z){et(!0);try{if(!(await fetch("/api/containers/".concat(Z.id,"/settings"),{method:"PUT",headers:{Authorization:"Bearer ".concat(_),"Content-Type":"application/json"},body:JSON.stringify({has_web_ui:ea,web_ui_port:ea&&el?parseInt(el):null,web_ui_path:ea?ei||"/":null,icon:eo||null,auto_start:ex})})).ok)throw Error("Failed to save settings");await ep(),alert("Settings saved successfully")}catch(e){alert(e instanceof Error?e.message:"Failed to save settings")}finally{et(!1)}}},eg=e=>e&&"0001-01-01T00:00:00Z"!==e?new Date(e).toLocaleString():"-";if(t||!s)return(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)(p.A,{className:"w-12 h-12 text-accent animate-spin"})});if(!U)return(0,a.jsx)(c.N,{title:"ERROR",time:I,children:(0,a.jsx)("div",{className:"h-[calc(100vh-3.5rem)] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(j.A,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"No Container Specified"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Please select a container from the manager."}),(0,a.jsx)(i.$,{onClick:()=>D.push("/container-manager"),children:"Return to Container Manager"})]})})});if(H)return(0,a.jsx)(c.N,{title:"LOADING...",time:I,children:(0,a.jsx)("div",{className:"h-[calc(100vh-3.5rem)] flex items-center justify-center",children:(0,a.jsx)(p.A,{className:"w-12 h-12 text-accent animate-spin"})})});if(q||!Z)return(0,a.jsx)(c.N,{title:"ERROR",time:I,children:(0,a.jsx)("div",{className:"h-[calc(100vh-3.5rem)] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(j.A,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Container Not Found"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:q||"The container could not be found."}),(0,a.jsx)(i.$,{onClick:()=>D.push("/container-manager"),children:"Return to Container Manager"})]})})});let eN="running"===Z.status;return(0,a.jsx)(c.N,{title:Z.name.toUpperCase(),time:I,children:(0,a.jsxs)("div",{className:"h-[calc(100vh-3.5rem)] flex flex-col",children:[(0,a.jsx)("div",{className:"shrink-0 border-b border-border/50 bg-card/50 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>D.push("/container-manager"),children:[(0,a.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[Z.icon?(0,a.jsx)("img",{src:Z.icon,alt:"",className:"w-10 h-10 rounded-lg"}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-cyan-500/20 border border-cyan-500/40 flex items-center justify-center",children:(0,a.jsx)(g.A,{className:"w-5 h-5 text-cyan-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:Z.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground font-mono",children:Z.image})]})]}),(0,a.jsx)(h.E,{variant:eN?"default":"secondary",className:eN?"bg-green-500/20 text-green-500 border-green-500/40":"",children:Z.status}),Z.uptime&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:Z.uptime})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[eN?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>ej("stop"),disabled:Q||!eh,title:eh?"Stop container":"Admin required",children:[Q?(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(N.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"ml-2",children:"Stop"})]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>ej("restart"),disabled:Q||!eh,title:eh?"Restart container":"Admin required",children:[(0,a.jsx)(v.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"ml-2",children:"Restart"})]})]}):(0,a.jsxs)(i.$,{variant:"default",size:"sm",onClick:()=>ej("start"),disabled:Q||!eh,title:eh?"Start container":"Admin required",children:[Q?(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(b.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"ml-2",children:"Start"})]}),Z.has_web_ui&&eN&&(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>D.push("/container-app?id=".concat(Z.id)),children:[(0,a.jsx)(w.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"ml-2",children:"Open App"})]}),eh&&(0,a.jsx)(i.$,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>ej("remove"),disabled:Q||eN,title:eN?"Stop container first":"Remove container",children:(0,a.jsx)(y.A,{className:"w-4 h-4"})})]})]})})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsxs)(o.tU,{value:Y,onValueChange:K,className:"h-full flex flex-col",children:[(0,a.jsx)("div",{className:"shrink-0 px-6 pt-4 border-b border-border/30",children:(0,a.jsxs)(o.j7,{className:"bg-background/50",children:[(0,a.jsxs)(o.Xi,{value:"overview",className:"gap-2",children:[(0,a.jsx)(k.A,{className:"w-4 h-4"}),"Overview"]}),eN&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.Xi,{value:"stats",className:"gap-2",children:[(0,a.jsx)(A.A,{className:"w-4 h-4"}),"Stats"]}),(0,a.jsxs)(o.Xi,{value:"terminal",className:"gap-2",children:[(0,a.jsx)(C.A,{className:"w-4 h-4"}),"Terminal"]})]}),(0,a.jsxs)(o.Xi,{value:"logs",className:"gap-2",children:[(0,a.jsx)(S.A,{className:"w-4 h-4"}),"Logs"]}),(0,a.jsxs)(o.Xi,{value:"update",className:"gap-2",children:[(0,a.jsx)(R,{className:"w-4 h-4"}),"Update"]}),(0,a.jsxs)(o.Xi,{value:"settings",className:"gap-2",children:[(0,a.jsx)(M.A,{className:"w-4 h-4"}),"Settings"]})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,a.jsx)(o.av,{value:"overview",className:"h-full m-0 p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 text-cyan-400"}),"Container Information"]})}),(0,a.jsx)(d.Wu,{className:"space-y-3",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"ID"}),(0,a.jsx)("span",{className:"font-mono",children:Z.container_id.substring(0,12)}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Name"}),(0,a.jsx)("span",{children:Z.name}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Image"}),(0,a.jsx)("span",{className:"font-mono text-xs",children:Z.image}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,a.jsx)("span",{className:eN?"text-green-500":"text-muted-foreground",children:Z.status}),W&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Created"}),(0,a.jsx)("span",{children:eg(W.Created)}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Started"}),(0,a.jsx)("span",{children:eg(W.State.StartedAt)}),W.State.Pid>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"PID"}),(0,a.jsx)("span",{children:W.State.Pid})]})]})]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(E.A,{className:"w-4 h-4 text-blue-400"}),"Network"]})}),(0,a.jsxs)(d.Wu,{className:"space-y-3",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:(null==W?void 0:W.NetworkSettings)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"IP Address"}),(0,a.jsx)("span",{className:"font-mono",children:W.NetworkSettings.IPAddress||"-"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Gateway"}),(0,a.jsx)("span",{className:"font-mono",children:W.NetworkSettings.Gateway||"-"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"MAC Address"}),(0,a.jsx)("span",{className:"font-mono text-xs",children:W.NetworkSettings.MacAddress||"-"})]})}),Z.ports&&Z.ports.length>0&&(0,a.jsxs)("div",{className:"pt-3 border-t border-border/50",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Port Mappings"}),(0,a.jsx)("div",{className:"mt-2 space-y-1",children:Z.ports.map((e,s)=>(0,a.jsxs)("div",{className:"text-sm font-mono bg-muted/30 px-2 py-1 rounded",children:[e.host_port," → ",e.container_port,"/",e.protocol]},s))})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(B.A,{className:"w-4 h-4 text-purple-400"}),"Resources"]})}),(0,a.jsx)(d.Wu,{className:"space-y-3",children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:(null==W?void 0:W.HostConfig)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Memory Limit"}),(0,a.jsx)("span",{children:W.HostConfig.Memory>0?(e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]})(W.HostConfig.Memory):"Unlimited"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"CPU Limit"}),(0,a.jsx)("span",{children:W.HostConfig.NanoCpus>0?"".concat((W.HostConfig.NanoCpus/1e9).toFixed(2)," cores"):"Unlimited"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Restart Policy"}),(0,a.jsx)("span",{children:(null==(e=W.HostConfig.RestartPolicy)?void 0:e.Name)||"no"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Privileged"}),(0,a.jsx)("span",{children:W.HostConfig.Privileged?"Yes":"No"})]})})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(F.A,{className:"w-4 h-4 text-amber-400"}),"Volumes & Mounts"]})}),(0,a.jsx)(d.Wu,{children:(null==W?void 0:W.Mounts)&&W.Mounts.length>0?(0,a.jsx)("div",{className:"space-y-2",children:W.Mounts.map((e,s)=>(0,a.jsxs)("div",{className:"text-sm bg-muted/30 p-2 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(h.E,{variant:"outline",className:"text-xs",children:e.Type}),!e.RW&&(0,a.jsx)(h.E,{variant:"secondary",className:"text-xs",children:"Read-only"})]}),(0,a.jsx)("div",{className:"font-mono text-xs text-muted-foreground truncate",title:e.Source,children:e.Source}),(0,a.jsxs)("div",{className:"font-mono text-xs",children:["→ ",e.Destination]})]},s))}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No volumes mounted"})})]})]})}),eN&&(0,a.jsx)(o.av,{value:"stats",className:"h-full m-0 p-6",children:(0,a.jsx)(P,{containerId:Z.container_id,isRunning:eN})}),eN&&(0,a.jsx)(o.av,{value:"terminal",className:"h-full m-0 p-4",children:(0,a.jsx)($,{containerId:Z.container_id,containerName:Z.name})}),(0,a.jsx)(o.av,{value:"logs",className:"h-full m-0 p-4",children:(0,a.jsx)(G,{containerId:Z.container_id,containerName:Z.name})}),(0,a.jsx)(o.av,{value:"update",className:"h-full m-0 p-6 overflow-auto",children:(0,a.jsx)("div",{className:"max-w-2xl",children:(0,a.jsx)(en,{containerId:Z.container_id,currentImage:Z.image,hasVolumes:(null==W?void 0:W.Mounts)&&W.Mounts.some(e=>"bind"===e.Type)||!1})})}),(0,a.jsx)(o.av,{value:"settings",className:"h-full m-0 p-6",children:(0,a.jsxs)("div",{className:"max-w-2xl space-y-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"w-4 h-4 text-cyan-400"}),"Desktop App Settings"]})}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x.J,{children:"Has Web UI"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Show as desktop app with icon"})]}),(0,a.jsx)(u.d,{checked:ea,onCheckedChange:er,disabled:!eh})]}),ea&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Web UI Port"}),(0,a.jsx)(m.p,{type:"number",placeholder:"8080",value:el,onChange:e=>ec(e.target.value),disabled:!eh}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Host port for web interface"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Web UI Path"}),(0,a.jsx)(m.p,{placeholder:"/",value:ei,onChange:e=>ed(e.target.value),disabled:!eh}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:'URL path (usually "/")'})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Icon URL"}),(0,a.jsx)(m.p,{placeholder:"https://example.com/icon.svg",value:eo,onChange:e=>em(e.target.value),disabled:!eh}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"URL to icon image for desktop shortcut"})]})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(M.A,{className:"w-4 h-4 text-amber-400"}),"Container Options"]})}),(0,a.jsx)(d.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x.J,{children:"Auto Start"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start container when Stardeck starts"})]}),(0,a.jsx)(u.d,{checked:ex,onCheckedChange:eu,disabled:!eh})]})})]}),eh&&(0,a.jsxs)(i.$,{onClick:ef,disabled:es,children:[es?(0,a.jsx)(p.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,a.jsx)(L.A,{className:"w-4 h-4 mr-2"}),"Save Settings"]})]})})]})]})})]})})}function ec(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)(p.A,{className:"w-12 h-12 text-accent animate-spin"})}),children:(0,a.jsx)(el,{})})}},52498:(e,s,t)=>{"use strict";t.d(s,{rc:()=>D,ZD:()=>U,UC:()=>z,VY:()=>O,hJ:()=>L,ZL:()=>F,bL:()=>E,hE:()=>I,l9:()=>B});var a=t(12115),r=t(3468),n=t(94446),l=t(41590),c=t(92556),i=t(95155),d=Symbol("radix.slottable"),o="AlertDialog",[m,x]=(0,r.A)(o,[l.Hs]),u=(0,l.Hs)(),h=e=>{let{__scopeAlertDialog:s,...t}=e,a=u(s);return(0,i.jsx)(l.bL,{...a,...t,modal:!0})};h.displayName=o;var p=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...a}=e,r=u(t);return(0,i.jsx)(l.l9,{...r,...a,ref:s})});p.displayName="AlertDialogTrigger";var j=e=>{let{__scopeAlertDialog:s,...t}=e,a=u(s);return(0,i.jsx)(l.ZL,{...a,...t})};j.displayName="AlertDialogPortal";var f=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...a}=e,r=u(t);return(0,i.jsx)(l.hJ,{...r,...a,ref:s})});f.displayName="AlertDialogOverlay";var g="AlertDialogContent",[N,v]=m(g),b=function(e){let s=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});return s.displayName=`${e}.Slottable`,s.__radixId=d,s}("AlertDialogContent"),w=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,children:r,...d}=e,o=u(t),m=a.useRef(null),x=(0,n.s)(s,m),h=a.useRef(null);return(0,i.jsx)(l.G$,{contentName:g,titleName:y,docsSlug:"alert-dialog",children:(0,i.jsx)(N,{scope:t,cancelRef:h,children:(0,i.jsxs)(l.UC,{role:"alertdialog",...o,...d,ref:x,onOpenAutoFocus:(0,c.mK)(d.onOpenAutoFocus,e=>{var s;e.preventDefault(),null==(s=h.current)||s.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,i.jsx)(b,{children:r}),(0,i.jsx)(M,{contentRef:m})]})})})});w.displayName=g;var y="AlertDialogTitle",k=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...a}=e,r=u(t);return(0,i.jsx)(l.hE,{...r,...a,ref:s})});k.displayName=y;var A="AlertDialogDescription",C=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...a}=e,r=u(t);return(0,i.jsx)(l.VY,{...r,...a,ref:s})});C.displayName=A;var S=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...a}=e,r=u(t);return(0,i.jsx)(l.bm,{...r,...a,ref:s})});S.displayName="AlertDialogAction";var _="AlertDialogCancel",R=a.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...a}=e,{cancelRef:r}=v(_,t),c=u(t),d=(0,n.s)(s,r);return(0,i.jsx)(l.bm,{...c,...a,ref:d})});R.displayName=_;var M=e=>{let{contentRef:s}=e,t="`".concat(g,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(g,"` by passing a `").concat(A,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(g,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return a.useEffect(()=>{var e;document.getElementById(null==(e=s.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},E=h,B=p,F=j,L=f,z=w,D=S,U=R,I=k,O=C}},e=>{e.O(0,[110,6263,7924,4505,9213,5259,7014,7052,2940,2312,2618,8441,1255,7358],()=>e(e.s=30426)),_N_E=e.O()}]);