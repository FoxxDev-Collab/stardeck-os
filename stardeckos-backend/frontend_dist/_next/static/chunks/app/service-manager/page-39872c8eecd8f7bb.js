(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2384],{6132:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},32380:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(95155),r=s(12115),l=s(20063),i=s(6707),c=s(83209),n=s(97003),d=s(33789),o=s(22312),u=s(50906),m=s(61362),x=s(78874),f=s(6132),h=s(15870),p=s(86651),b=s(52952),g=s(85921),v=s(59e3),j=s(93141);function N(){let{isAuthenticated:e,isLoading:t,token:s,user:N}=(0,i.A)(),y=(0,l.useRouter)(),[w,k]=(0,r.useState)(""),A=(null==N?void 0:N.role)==="admin"||(null==N?void 0:N.role)==="operator"||(null==N?void 0:N.is_pam_admin),[S,_]=(0,r.useState)([]),[C,z]=(0,r.useState)(""),[E,R]=(0,r.useState)("all"),[Z,B]=(0,r.useState)(null),[$,F]=(0,r.useState)(null),W=(0,r.useCallback)(async()=>{if(s)try{let e=await fetch("/api/services",{headers:{Authorization:"Bearer ".concat(s)}});if(!e.ok)throw Error("Failed to fetch services");let t=await e.json();_(t||[]),B(null)}catch(e){B(e instanceof Error?e.message:"Failed to load services")}},[s]);if((0,r.useEffect)(()=>{t||e?t||!e||A||y.push("/dashboard"):y.push("/login")},[e,t,A,y]),(0,r.useEffect)(()=>{let e=()=>{k(new Date().toLocaleTimeString("en-US",{hour12:!1}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[]),(0,r.useEffect)(()=>{if(e&&s){W();let e=setInterval(W,1e4);return()=>clearInterval(e)}},[e,s,W]),t||!e||!A)return(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"w-12 h-12 text-accent animate-pulse"})});let I=S.filter(e=>{let t=e.name.toLowerCase().includes(C.toLowerCase()),s="active"===e.active_state?"running":"failed"===e.active_state?"failed":"stopped";return t&&("all"===E||s===E)}),T=S.filter(e=>"active"===e.active_state).length,q=S.filter(e=>"inactive"===e.active_state).length,L=S.filter(e=>"failed"===e.active_state).length,O=async(e,t)=>{if(s){F(e);try{let a=await fetch("/api/services/".concat(e,"/").concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(s)}});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.error||"Failed to ".concat(t," service"))}await W()}catch(e){alert(e instanceof Error?e.message:"Failed to ".concat(t," service"))}finally{F(null)}}},M=e=>"active"===e.active_state?"running":"failed"===e.active_state?"failed":"stopped";return(0,a.jsx)(o.N,{title:"SERVICE MANAGER",time:w,children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(c.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Total Services"}),(0,a.jsx)(h.A,{className:"w-4 h-4 text-accent"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"text-3xl font-bold",children:S.length})})]}),(0,a.jsxs)(c.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Running"}),(0,a.jsx)(m.A,{className:"w-4 h-4 text-primary"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"text-3xl font-bold text-primary",children:T})})]}),(0,a.jsxs)(c.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Stopped"}),(0,a.jsx)(x.A,{className:"w-4 h-4 text-muted-foreground"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"text-3xl font-bold",children:q})})]}),(0,a.jsxs)(c.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Failed"}),(0,a.jsx)(f.A,{className:"w-4 h-4 text-destructive"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"text-3xl font-bold text-destructive",children:L})})]})]}),(0,a.jsxs)(c.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,a.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 text-accent"}),"System Services"]}),(0,a.jsxs)("div",{className:"flex gap-2 w-full md:w-auto flex-wrap",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{variant:"all"===E?"default":"outline",size:"sm",onClick:()=>R("all"),className:"all"===E?"bg-accent hover:bg-accent/90":"",children:"All"}),(0,a.jsx)(n.$,{variant:"running"===E?"default":"outline",size:"sm",onClick:()=>R("running"),className:"running"===E?"bg-primary hover:bg-primary/90":"",children:"Running"}),(0,a.jsx)(n.$,{variant:"stopped"===E?"default":"outline",size:"sm",onClick:()=>R("stopped"),children:"Stopped"}),(0,a.jsx)(n.$,{variant:"failed"===E?"default":"outline",size:"sm",onClick:()=>R("failed"),className:"failed"===E?"bg-destructive hover:bg-destructive/90":"",children:"Failed"})]}),(0,a.jsxs)("div",{className:"relative flex-1 md:w-64",children:[(0,a.jsx)(p.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(d.p,{placeholder:"Search services...",value:C,onChange:e=>z(e.target.value),className:"pl-10 bg-input/80 border-border/60"})]})]})]})}),(0,a.jsxs)(c.Wu,{children:[Z&&(0,a.jsx)("div",{className:"p-4 mb-4 rounded-lg border border-destructive/50 bg-destructive/10 text-destructive",children:Z}),(0,a.jsx)("div",{className:"space-y-2",children:I.map((e,t)=>{let s=M(e);return(0,a.jsx)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40 hover:bg-background/60 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(e=>{switch(M(e)){case"running":return(0,a.jsx)(m.A,{className:"w-4 h-4 text-primary"});case"stopped":return(0,a.jsx)(x.A,{className:"w-4 h-4 text-muted-foreground"});case"failed":return(0,a.jsx)(f.A,{className:"w-4 h-4 text-destructive"})}})(e),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("h3",{className:"font-semibold text-foreground",children:e.name})}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground mt-1",children:[(0,a.jsx)("span",{className:"running"===s?"text-primary":"failed"===s?"text-destructive":"text-muted-foreground",children:s.toUpperCase()}),e.description&&(0,a.jsx)("span",{className:"truncate max-w-md",children:e.description}),e.enabled&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"w-3 h-3"}),"Auto-start"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>O(e.name,"start"),disabled:"running"===s||$===e.name,className:"gap-2",children:[(0,a.jsx)(g.A,{className:"w-3 h-3"}),"Start"]}),(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>O(e.name,"stop"),disabled:"stopped"===s||$===e.name,className:"gap-2",children:[(0,a.jsx)(v.A,{className:"w-3 h-3"}),"Stop"]}),(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>O(e.name,"restart"),disabled:"stopped"===s||$===e.name,className:"gap-2",children:[(0,a.jsx)(j.A,{className:"w-3 h-3"}),"Restart"]})]})]})},"".concat(e.name,"-").concat(t))})})]})]})]})})}},33789:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var a=s(95155);s(12115);var r=s(25016);function l(e){let{className:t,type:s,...l}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...l})}},57657:(e,t,s)=>{Promise.resolve().then(s.bind(s,32380))},59e3:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]])},61362:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},78874:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>n,Wu:()=>d,ZB:()=>c,Zp:()=>l,aR:()=>i});var a=s(95155);s(12115);var r=s(25016);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...s})}function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...s})}},85921:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},86651:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}},e=>{e.O(0,[110,6263,7924,2940,2312,8441,1255,7358],()=>e(e.s=57657)),_N_E=e.O()}]);