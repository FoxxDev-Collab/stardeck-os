(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6519],{17183:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>h});var r=t(95155),l=t(12115);t(20729);var s=t(20063),o=t(6707),a=t(22312),i=t(83209),c=t(97003),d=t(50803),u=t(97624),m=t(37354);function h(){let{user:e,isLoading:n}=(0,o.A)(),h=(0,s.useRouter)(),f=(0,l.useRef)(null),x=(0,l.useRef)(null),p=(0,l.useRef)(null),g=(0,l.useRef)(null),[w,b]=(0,l.useState)(!1),[j,v]=(0,l.useState)(!1),[y,N]=(0,l.useState)(!1),k=(null==e?void 0:e.role)==="admin"||(null==e?void 0:e.role)==="operator"||(null==e?void 0:e.is_pam_admin);return((0,l.useEffect)(()=>{n||e?n||!e||k||h.push("/dashboard"):h.push("/login")},[e,n,k,h]),(0,l.useEffect)(()=>{if(!f.current||!e)return;let n=null,r=null,l=null;(async()=>{let[{Terminal:e},{FitAddon:s},{WebLinksAddon:o}]=await Promise.all([t.e(1081).then(t.t.bind(t,45318,23)),t.e(4326).then(t.t.bind(t,34326,23)),t.e(3478).then(t.t.bind(t,73478,23))]);n=new e({cursorBlink:!0,fontSize:14,fontFamily:'Menlo, Monaco, "Courier New", monospace',theme:{background:"#1e1e1e",foreground:"#d4d4d4",cursor:"#d4d4d4",black:"#000000",red:"#cd3131",green:"#0dbc79",yellow:"#e5e510",blue:"#2472c8",magenta:"#bc3fbc",cyan:"#11a8cd",white:"#e5e5e5",brightBlack:"#666666",brightRed:"#f14c4c",brightGreen:"#23d18b",brightYellow:"#f5f543",brightBlue:"#3b8eea",brightMagenta:"#d670d6",brightCyan:"#29b8db",brightWhite:"#ffffff"},allowProposedApi:!0}),l=new s;let a=new o;n.loadAddon(l),n.loadAddon(a),g.current=l,x.current=n,f.current&&n.open(f.current),N(!0),setTimeout(()=>{try{null==l||l.fit()}catch(e){console.error("Error fitting terminal:",e)}},10);let i=localStorage.getItem("stardeck-token");if(!i)return n.writeln("\r\n\x1b[1;31mNo authentication token found\x1b[0m\r\n");let c="3000"===window.location.port,d=c?"ws:":"https:"===window.location.protocol?"wss:":"ws:",u=c?"".concat(window.location.hostname,":8080"):window.location.host,m="".concat(d,"//").concat(u,"/api/terminal/ws?token=").concat(encodeURIComponent(i));console.log("Connecting to WebSocket:",m.replace(i,"***")),p.current=r=new WebSocket(m),r.onopen=()=>{b(!0),n&&(null==r||r.send(JSON.stringify({type:"resize",rows:n.rows,cols:n.cols})))},r.onmessage=e=>{null==n||n.write(e.data)},r.onerror=e=>{console.error("WebSocket error:",e),null==n||n.writeln("\r\n\x1b[1;31mWebSocket connection error\x1b[0m\r\n"),b(!1)},r.onclose=e=>{console.log("WebSocket closed:",e.code,e.reason),null==n||n.writeln("\r\n\x1b[1;33mConnection closed\x1b[0m\r\n"),b(!1)},n.onData(e=>{(null==r?void 0:r.readyState)===WebSocket.OPEN&&r.send(JSON.stringify({type:"input",data:e}))}),n.onResize(e=>{let{rows:n,cols:t}=e;(null==r?void 0:r.readyState)===WebSocket.OPEN&&r.send(JSON.stringify({type:"resize",rows:n,cols:t}))})})();let s=()=>{try{var e;null==(e=g.current)||e.fit()}catch(e){console.error("Error fitting terminal on resize:",e)}};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),null==r||r.close(),null==n||n.dispose()}},[e]),!n&&e&&k)?(0,r.jsx)(a.N,{children:(0,r.jsxs)("div",{className:"flex flex-col ".concat(j?"h-screen":"h-full"," p-4 gap-4"),children:[(0,r.jsxs)(i.Zp,{className:j?"flex-1 flex flex-col":"",children:[(0,r.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"w-5 h-5"}),"Terminal"]}),(0,r.jsxs)(i.BT,{children:["Interactive shell terminal",w&&(0,r.jsx)("span",{className:"ml-2 text-green-600",children:"● Connected"}),!w&&(0,r.jsx)("span",{className:"ml-2 text-red-600",children:"● Disconnected"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[!w&&y&&(0,r.jsx)(c.$,{onClick:()=>{p.current&&p.current.close(),window.location.reload()},variant:"outline",size:"sm",children:"Reconnect"}),(0,r.jsx)(c.$,{onClick:()=>{v(!j),setTimeout(()=>{try{var e;null==(e=g.current)||e.fit()}catch(e){console.error("Error fitting terminal in fullscreen:",e)}},100)},variant:"outline",size:"sm",className:"flex items-center gap-2",children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"w-4 h-4"}),"Exit Fullscreen"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),"Fullscreen"]})})]})]}),(0,r.jsx)(i.Wu,{className:j?"flex-1 p-0":"p-0",children:(0,r.jsx)("div",{ref:f,className:"w-full ".concat(j?"h-full":"h-[600px]"," bg-[#1e1e1e] rounded-b-lg overflow-hidden"),style:{padding:"8px"}})})]}),!j&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Terminal Tips"})}),(0,r.jsxs)(i.Wu,{className:"space-y-2 text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"• This is a fully interactive shell terminal running on the server"}),(0,r.jsx)("p",{children:"• Supports colors, cursor movement, and all standard terminal features"}),(0,r.jsx)("p",{children:"• Use Ctrl+C to interrupt running processes"}),(0,r.jsx)("p",{children:"• Your default shell environment is loaded automatically"}),(0,r.jsx)("p",{children:"• Terminal sessions are isolated per connection"})]})]})]})}):(0,r.jsx)(a.N,{children:(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("p",{children:"Loading..."})})})}},20729:()=>{},37354:(e,n,t)=>{"use strict";t.d(n,{A:()=>r});let r=(0,t(71847).A)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]])},69570:(e,n,t)=>{Promise.resolve().then(t.bind(t,17183))},83209:(e,n,t)=>{"use strict";t.d(n,{BT:()=>i,Wu:()=>c,ZB:()=>a,Zp:()=>s,aR:()=>o});var r=t(95155);t(12115);var l=t(25016);function s(e){let{className:n,...t}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...t})}function o(e){let{className:n,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...t})}function a(e){let{className:n,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-semibold",n),...t})}function i(e){let{className:n,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-muted-foreground text-sm",n),...t})}function c(e){let{className:n,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",n),...t})}},97624:(e,n,t)=>{"use strict";t.d(n,{A:()=>r});let r=(0,t(71847).A)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]])}},e=>{e.O(0,[3786,110,6263,7924,2940,2312,8441,1255,7358],()=>e(e.s=69570)),_N_E=e.O()}]);