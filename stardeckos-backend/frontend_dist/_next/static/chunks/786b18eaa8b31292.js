(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";e.s(["Plus",()=>t],7233);let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},94179,e=>{"use strict";e.s(["Badge",()=>l]);var t=e.i(43476),a=e.i(25913),s=e.i(47163);let r=(0,a.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:a,variant:l,...n}=e;return(0,t.jsx)("div",{className:(0,s.cn)(r({variant:l}),a),...n})}},30009,e=>{"use strict";e.s(["AlertDialog",()=>z,"AlertDialogAction",()=>V,"AlertDialogCancel",()=>H,"AlertDialogContent",()=>F,"AlertDialogDescription",()=>O,"AlertDialogFooter",()=>M,"AlertDialogHeader",()=>E,"AlertDialogTitle",()=>L,"AlertDialogTrigger",()=>I],30009);var t=e.i(43476),a=e.i(71645),s=e.i(30030),r=e.i(20783),l=e.i(26999),n=e.i(81140),i=Symbol("radix.slottable"),c="AlertDialog",[o,d]=(0,s.createContextScope)(c,[l.createDialogScope]),x=(0,l.createDialogScope)(),h=e=>{let{__scopeAlertDialog:a,...s}=e,r=x(a);return(0,t.jsx)(l.Root,{...r,...s,modal:!0})};h.displayName=c;var m=a.forwardRef((e,a)=>{let{__scopeAlertDialog:s,...r}=e,n=x(s);return(0,t.jsx)(l.Trigger,{...n,...r,ref:a})});m.displayName="AlertDialogTrigger";var u=e=>{let{__scopeAlertDialog:a,...s}=e,r=x(a);return(0,t.jsx)(l.Portal,{...r,...s})};u.displayName="AlertDialogPortal";var j=a.forwardRef((e,a)=>{let{__scopeAlertDialog:s,...r}=e,n=x(s);return(0,t.jsx)(l.Overlay,{...n,...r,ref:a})});j.displayName="AlertDialogOverlay";var p="AlertDialogContent",[g,f]=o(p),v=function(e){let a=e=>{let{children:a}=e;return(0,t.jsx)(t.Fragment,{children:a})};return a.displayName="".concat(e,".Slottable"),a.__radixId=i,a}("AlertDialogContent"),N=a.forwardRef((e,s)=>{let{__scopeAlertDialog:i,children:c,...o}=e,d=x(i),h=a.useRef(null),m=(0,r.useComposedRefs)(s,h),u=a.useRef(null);return(0,t.jsx)(l.WarningProvider,{contentName:p,titleName:b,docsSlug:"alert-dialog",children:(0,t.jsx)(g,{scope:i,cancelRef:u,children:(0,t.jsxs)(l.Content,{role:"alertdialog",...d,...o,ref:m,onOpenAutoFocus:(0,n.composeEventHandlers)(o.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=u.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,t.jsx)(v,{children:c}),(0,t.jsx)(D,{contentRef:h})]})})})});N.displayName=p;var b="AlertDialogTitle",w=a.forwardRef((e,a)=>{let{__scopeAlertDialog:s,...r}=e,n=x(s);return(0,t.jsx)(l.Title,{...n,...r,ref:a})});w.displayName=b;var y="AlertDialogDescription",C=a.forwardRef((e,a)=>{let{__scopeAlertDialog:s,...r}=e,n=x(s);return(0,t.jsx)(l.Description,{...n,...r,ref:a})});C.displayName=y;var k=a.forwardRef((e,a)=>{let{__scopeAlertDialog:s,...r}=e,n=x(s);return(0,t.jsx)(l.Close,{...n,...r,ref:a})});k.displayName="AlertDialogAction";var S="AlertDialogCancel",A=a.forwardRef((e,a)=>{let{__scopeAlertDialog:s,...n}=e,{cancelRef:i}=f(S,s),c=x(s),o=(0,r.useComposedRefs)(a,i);return(0,t.jsx)(l.Close,{...c,...n,ref:o})});A.displayName=S;var D=e=>{let{contentRef:t}=e,s="`".concat(p,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(p,"` by passing a `").concat(y,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(p,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return a.useEffect(()=>{var e;document.getElementById(null==(e=t.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},T=e.i(47163),B=e.i(67881);function z(e){let{...a}=e;return(0,t.jsx)(h,{"data-slot":"alert-dialog",...a})}function I(e){let{...a}=e;return(0,t.jsx)(m,{"data-slot":"alert-dialog-trigger",...a})}function P(e){let{...a}=e;return(0,t.jsx)(u,{"data-slot":"alert-dialog-portal",...a})}function R(e){let{className:a,...s}=e;return(0,t.jsx)(j,{"data-slot":"alert-dialog-overlay",className:(0,T.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...s})}function F(e){let{className:a,...s}=e;return(0,t.jsxs)(P,{children:[(0,t.jsx)(R,{}),(0,t.jsx)(N,{"data-slot":"alert-dialog-content",className:(0,T.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...s})]})}function E(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,T.cn)("flex flex-col gap-2 text-center sm:text-left",a),...s})}function M(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,T.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...s})}function L(e){let{className:a,...s}=e;return(0,t.jsx)(w,{"data-slot":"alert-dialog-title",className:(0,T.cn)("text-lg font-semibold",a),...s})}function O(e){let{className:a,...s}=e;return(0,t.jsx)(C,{"data-slot":"alert-dialog-description",className:(0,T.cn)("text-muted-foreground text-sm",a),...s})}function V(e){let{className:a,...s}=e;return(0,t.jsx)(k,{className:(0,T.cn)((0,B.buttonVariants)(),a),...s})}function H(e){let{className:a,...s}=e;return(0,t.jsx)(A,{className:(0,T.cn)((0,B.buttonVariants)({variant:"outline"}),a),...s})}},99602,e=>{"use strict";e.s(["ArrowUpDown",()=>t],99602);let t=(0,e.i(75254).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]])},17566,e=>{"use strict";e.s(["default",()=>z],17566);var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(91432),l=e.i(70065),n=e.i(67881),i=e.i(23750),c=e.i(10708),o=e.i(27341),d=e.i(94179),x=e.i(30374),h=e.i(62870),m=e.i(30009),u=e.i(48654),j=e.i(21218),p=e.i(78094),g=e.i(98919),f=e.i(75254);let v=(0,f.default)("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),N=(0,f.default)("cable",[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]]);var b=e.i(16715),w=e.i(7233),y=e.i(27612),C=e.i(43531),k=e.i(37727),S=e.i(99602),A=e.i(48256),D=e.i(18393),T=e.i(53475),B=e.i(78894);function z(){let{isAuthenticated:e,isLoading:f,token:z,user:I}=(0,r.useAuth)(),P=(0,s.useRouter)(),[R,F]=(0,a.useState)(""),[E,M]=(0,a.useState)("interfaces"),L=(null==I?void 0:I.role)==="admin"||(null==I?void 0:I.role)==="operator"||(null==I?void 0:I.is_pam_admin),[O,V]=(0,a.useState)([]),[H,_]=(0,a.useState)({}),[U,G]=(0,a.useState)(null),[X,q]=(0,a.useState)([]),[W,K]=(0,a.useState)([]),[J,Q]=(0,a.useState)([]),[Y,Z]=(0,a.useState)(null),[$,ee]=(0,a.useState)([]),[et,ea]=(0,a.useState)(null),[es,er]=(0,a.useState)(!1),[el,en]=(0,a.useState)(!1),[ei,ec]=(0,a.useState)(!1),[eo,ed]=(0,a.useState)(!1),[ex,eh]=(0,a.useState)(!1),[em,eu]=(0,a.useState)(!1),[ej,ep]=(0,a.useState)({success:!1,message:""}),[eg,ef]=(0,a.useState)(null),[ev,eN]=(0,a.useState)(""),[eb,ew]=(0,a.useState)({port:"",protocol:"tcp"}),[ey,eC]=(0,a.useState)({destination:"",gateway:"",interface:"",metric:0}),[ek,eS]=(0,a.useState)({type:"",zone:"",value:""}),[eA,eD]=(0,a.useState)({protocol:"",state:""}),eT=(null==I?void 0:I.role)==="admin",eB=(0,a.useCallback)(async()=>{if(z)try{let e=await fetch("/api/network/interfaces",{headers:{Authorization:"Bearer ".concat(z)}});if(e.ok){let t=await e.json();V(t||[]);let a=(t||[]).map(async e=>{let t=await fetch("/api/network/interfaces/".concat(e.name,"/stats"),{headers:{Authorization:"Bearer ".concat(z)}});return t.ok?{name:e.name,stats:await t.json()}:null}),s=await Promise.all(a),r={};s.forEach(e=>{e&&(r[e.name]=e.stats)}),_(r)}}catch(e){console.error("Failed to fetch interfaces:",e)}},[z]),ez=(0,a.useCallback)(async()=>{if(z)try{let[e,t,a]=await Promise.all([fetch("/api/network/firewall/status",{headers:{Authorization:"Bearer ".concat(z)}}),fetch("/api/network/firewall/zones",{headers:{Authorization:"Bearer ".concat(z)}}),fetch("/api/network/firewall/services",{headers:{Authorization:"Bearer ".concat(z)}})]);e.ok&&G(await e.json()),t.ok&&q(await t.json()),a.ok&&K(await a.json())}catch(e){console.error("Failed to fetch firewall data:",e)}},[z]),eI=(0,a.useCallback)(async()=>{if(z)try{let[e,t]=await Promise.all([fetch("/api/network/routes",{headers:{Authorization:"Bearer ".concat(z)}}),fetch("/api/network/dns",{headers:{Authorization:"Bearer ".concat(z)}})]);e.ok&&Q(await e.json()),t.ok&&Z(await t.json())}catch(e){console.error("Failed to fetch routes:",e)}},[z]),eP=(0,a.useCallback)(async()=>{if(z)try{let e=new URLSearchParams;eA.protocol&&e.append("protocol",eA.protocol),eA.state&&e.append("state",eA.state);let t=await fetch("/api/network/connections?".concat(e),{headers:{Authorization:"Bearer ".concat(z)}});t.ok&&ee(await t.json())}catch(e){console.error("Failed to fetch connections:",e)}},[z,eA]),eR=(0,a.useCallback)(async()=>{er(!0),ea(null);try{await Promise.all([eB(),ez(),eI(),eP()])}catch(e){ea(e instanceof Error?e.message:"Failed to fetch network data")}finally{er(!1)}},[eB,ez,eI,eP]);(0,a.useEffect)(()=>{f||e?f||!e||L||P.push("/dashboard"):P.push("/login")},[e,f,L,P]),(0,a.useEffect)(()=>{let e=()=>{F(new Date().toLocaleTimeString("en-US",{hour12:!1}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[]),(0,a.useEffect)(()=>{if(e&&z){eR();let e=setInterval(eR,3e4);return()=>clearInterval(e)}},[e,z,eR]),(0,a.useEffect)(()=>{e&&z&&eP()},[eA,e,z,eP]);let eF=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,t)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][t])},eE=async()=>{if(eg&&ev&&z)try{let e=await fetch("/api/network/firewall/zones/".concat(eg.name,"/services"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(z)},body:JSON.stringify({service:ev,permanent:!0})}),t=await e.json();ep({success:e.ok,message:e.ok?"Service added successfully":t.error||"Failed to add service"}),eu(!0),en(!1),e.ok&&ez()}catch(e){ep({success:!1,message:"Failed to add service"}),eu(!0)}},eM=async()=>{if(eg&&eb.port&&z)try{let e=await fetch("/api/network/firewall/zones/".concat(eg.name,"/ports"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(z)},body:JSON.stringify({port:parseInt(eb.port),protocol:eb.protocol,permanent:!0})}),t=await e.json();ep({success:e.ok,message:e.ok?"Port added successfully":t.error||"Failed to add port"}),eu(!0),ec(!1),e.ok&&ez()}catch(e){ep({success:!1,message:"Failed to add port"}),eu(!0)}},eL=async()=>{if(ey.destination&&z)try{let e=await fetch("/api/network/routes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(z)},body:JSON.stringify(ey)}),t=await e.json();ep({success:e.ok,message:e.ok?"Route added successfully":t.error||"Failed to add route"}),eu(!0),ed(!1),e.ok&&eI()}catch(e){ep({success:!1,message:"Failed to add route"}),eu(!0)}},eO=async()=>{if(z)try{let e;if("service"===ek.type?e=await fetch("/api/network/firewall/zones/".concat(ek.zone,"/services/").concat(ek.value,"?permanent=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(z)}}):"port"===ek.type?e=await fetch("/api/network/firewall/zones/".concat(ek.zone,"/ports/").concat(ek.value,"?permanent=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(z)}}):"route"===ek.type&&(e=await fetch("/api/network/routes/".concat(encodeURIComponent(ek.value)),{method:"DELETE",headers:{Authorization:"Bearer ".concat(z)}})),e){let t=await e.json();ep({success:e.ok,message:e.ok?"Deleted successfully":t.error||"Failed to delete"}),eu(!0),eh(!1),e.ok&&("route"===ek.type?eI():ez())}}catch(e){ep({success:!1,message:"Failed to delete"}),eu(!0)}},eV=async()=>{if(z)try{let e=await fetch("/api/network/firewall/reload",{method:"POST",headers:{Authorization:"Bearer ".concat(z)}}),t=await e.json();ep({success:e.ok,message:e.ok?"Firewall reloaded":t.error||"Failed to reload"}),eu(!0),e.ok&&ez()}catch(e){ep({success:!1,message:"Failed to reload firewall"}),eu(!0)}};return!f&&e&&L?(0,t.jsxs)(u.DashboardLayout,{title:"NETWORK MANAGER",time:R,children:[(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Interfaces"}),(0,t.jsx)(p.Network,{className:"w-4 h-4 text-accent"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:O.length}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[O.filter(e=>"up"===e.state).length," active"]})]})]}),(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Firewall"}),(0,t.jsx)(g.Shield,{className:"w-4 h-4 text-chart-3"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsxs)("div",{className:"text-3xl font-bold flex items-center gap-2",children:[(null==U?void 0:U.running)?(0,t.jsx)(C.Check,{className:"w-6 h-6 text-green-500"}):(0,t.jsx)(k.X,{className:"w-6 h-6 text-destructive"}),(null==U?void 0:U.running)?"Active":"Inactive"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Default: ",(null==U?void 0:U.default_zone)||"N/A"]})]})]}),(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Routes"}),(0,t.jsx)(v,{className:"w-4 h-4 text-chart-4"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:J.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"routing entries"})]})]}),(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),(0,t.jsx)(S.ArrowUpDown,{className:"w-4 h-4 text-chart-5"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:$.length}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[$.filter(e=>"ESTAB"===e.state).length," established"]})]})]})]}),et&&(0,t.jsx)("div",{className:"p-4 rounded-lg border border-destructive/50 bg-destructive/10 text-destructive",children:et}),(0,t.jsxs)(o.Tabs,{value:E,onValueChange:M,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)(o.TabsList,{children:[(0,t.jsxs)(o.TabsTrigger,{value:"interfaces",className:"gap-2",children:[(0,t.jsx)(p.Network,{className:"w-4 h-4"}),"Interfaces"]}),(0,t.jsxs)(o.TabsTrigger,{value:"firewall",className:"gap-2",children:[(0,t.jsx)(g.Shield,{className:"w-4 h-4"}),"Firewall"]}),(0,t.jsxs)(o.TabsTrigger,{value:"routes",className:"gap-2",children:[(0,t.jsx)(v,{className:"w-4 h-4"}),"Routes"]}),(0,t.jsxs)(o.TabsTrigger,{value:"connections",className:"gap-2",children:[(0,t.jsx)(S.ArrowUpDown,{className:"w-4 h-4"}),"Connections"]})]}),(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:eR,disabled:es,children:(0,t.jsx)(b.RefreshCw,{className:"w-4 h-4 ".concat(es?"animate-spin":"")})})]}),(0,t.jsx)(o.TabsContent,{value:"interfaces",children:(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Network,{className:"w-5 h-5 text-accent"}),"Network Interfaces"]})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:O.map(e=>(0,t.jsx)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40",children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(e=>{switch(e){case"loopback":return(0,t.jsx)(D.Server,{className:"w-4 h-4"});case"wireless":return(0,t.jsx)(T.Wifi,{className:"w-4 h-4"});case"bridge":case"virtual":return(0,t.jsx)(p.Network,{className:"w-4 h-4"});default:return(0,t.jsx)(N,{className:"w-4 h-4"})}})(e.type),(0,t.jsx)("h3",{className:"font-semibold font-mono",children:e.name}),(0,t.jsx)(d.Badge,{variant:"up"===e.state?"default":"secondary",children:e.state}),(0,t.jsx)(d.Badge,{variant:"outline",children:e.type}),e.is_physical&&(0,t.jsx)(d.Badge,{variant:"outline",children:"Physical"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"MAC:"}),(0,t.jsx)("span",{className:"ml-2 font-mono",children:e.mac||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"MTU:"}),(0,t.jsx)("span",{className:"ml-2",children:e.mtu})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Speed:"}),(0,t.jsx)("span",{className:"ml-2",children:e.speed>0?"".concat(e.speed," Mbps"):"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Driver:"}),(0,t.jsx)("span",{className:"ml-2",children:e.driver||"N/A"})]})]}),(e.ipv4.length>0||e.ipv6.length>0)&&(0,t.jsxs)("div",{className:"mt-3 space-y-1",children:[e.ipv4.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(A.Globe,{className:"w-3 h-3 text-muted-foreground"}),(0,t.jsx)("span",{className:"font-mono text-accent",children:e}),(0,t.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:"IPv4"})]},a)),e.ipv6.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(A.Globe,{className:"w-3 h-3 text-muted-foreground"}),(0,t.jsx)("span",{className:"font-mono text-xs",children:e}),(0,t.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:"IPv6"})]},a))]}),H[e.name]&&(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-muted-foreground",children:[(0,t.jsxs)("div",{children:["RX: ",eF(H[e.name].rx_bytes)]}),(0,t.jsxs)("div",{children:["TX: ",eF(H[e.name].tx_bytes)]}),(0,t.jsxs)("div",{children:["Packets RX: ",H[e.name].rx_packets]}),(0,t.jsxs)("div",{children:["Packets TX: ",H[e.name].tx_packets]})]})]})})},e.name))})})]})}),(0,t.jsx)(o.TabsContent,{value:"firewall",children:(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(g.Shield,{className:"w-5 h-5 text-chart-3"}),"Firewall Zones"]}),eT&&(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:eV,children:[(0,t.jsx)(b.RefreshCw,{className:"w-4 h-4 mr-2"}),"Reload Firewall"]})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:X.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.name}),e.is_default&&(0,t.jsx)(d.Badge,{children:"Default"}),e.is_active&&(0,t.jsx)(d.Badge,{variant:"outline",className:"text-green-500 border-green-500",children:"Active"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Target: ",e.target||"default"]})]}),eT&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{ef(e),eN(""),en(!0)},children:[(0,t.jsx)(w.Plus,{className:"w-4 h-4 mr-1"}),"Service"]}),(0,t.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{ef(e),ew({port:"",protocol:"tcp"}),ec(!0)},children:[(0,t.jsx)(w.Plus,{className:"w-4 h-4 mr-1"}),"Port"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[e.interfaces.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Interfaces:"}),e.interfaces.map(e=>(0,t.jsx)(d.Badge,{variant:"secondary",children:e},e))]}),e.services.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Services:"}),e.services.map(a=>(0,t.jsxs)(d.Badge,{variant:"outline",className:"gap-1 cursor-pointer hover:bg-destructive/10",onClick:()=>{eT&&(eS({type:"service",zone:e.name,value:a}),eh(!0))},children:[a,eT&&(0,t.jsx)(k.X,{className:"w-3 h-3"})]},a))]}),e.ports.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Ports:"}),e.ports.map(a=>(0,t.jsxs)(d.Badge,{variant:"outline",className:"gap-1 cursor-pointer hover:bg-destructive/10",onClick:()=>{eT&&(eS({type:"port",zone:e.name,value:a}),eh(!0))},children:[a,eT&&(0,t.jsx)(k.X,{className:"w-3 h-3"})]},a))]}),e.masquerade&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsx)(C.Check,{className:"w-4 h-4 inline mr-1 text-green-500"}),"Masquerading enabled"]})]})]},e.name))})})]})}),(0,t.jsx)(o.TabsContent,{value:"routes",children:(0,t.jsxs)("div",{className:"space-y-6",children:[Y&&(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(A.Globe,{className:"w-5 h-5 text-chart-4"}),"DNS Configuration"]})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"Hostname"}),(0,t.jsx)("p",{className:"font-mono",children:Y.hostname})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"FQDN"}),(0,t.jsx)("p",{className:"font-mono",children:Y.fqdn||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"Nameservers"}),(0,t.jsx)("div",{className:"space-y-1",children:Y.nameservers.map((e,a)=>(0,t.jsx)("p",{className:"font-mono text-sm",children:e},a))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"Search Domains"}),(0,t.jsx)("div",{className:"space-y-1",children:Y.search.map((e,a)=>(0,t.jsx)("p",{className:"font-mono text-sm",children:e},a))})]})]})})]}),(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(v,{className:"w-5 h-5 text-chart-4"}),"Routing Table"]}),eT&&(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>{eC({destination:"",gateway:"",interface:"",metric:0}),ed(!0)},children:[(0,t.jsx)(w.Plus,{className:"w-4 h-4 mr-2"}),"Add Route"]})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border/50",children:[(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Destination"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Gateway"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Interface"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Metric"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Protocol"}),eT&&(0,t.jsx)("th",{className:"text-right p-2 text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:J.map((e,a)=>(0,t.jsxs)("tr",{className:"border-b border-border/30 hover:bg-muted/20",children:[(0,t.jsx)("td",{className:"p-2 font-mono",children:e.destination}),(0,t.jsx)("td",{className:"p-2 font-mono",children:e.gateway||"-"}),(0,t.jsx)("td",{className:"p-2",children:e.interface}),(0,t.jsx)("td",{className:"p-2",children:e.metric}),(0,t.jsx)("td",{className:"p-2",children:e.protocol}),eT&&(0,t.jsx)("td",{className:"p-2 text-right",children:(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{eS({type:"route",zone:"",value:e.destination}),eh(!0)},children:(0,t.jsx)(y.Trash2,{className:"w-4 h-4 text-destructive"})})})]},a))})]})})})]})]})}),(0,t.jsx)(o.TabsContent,{value:"connections",children:(0,t.jsxs)(l.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(S.ArrowUpDown,{className:"w-5 h-5 text-chart-5"}),"Active Connections"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(h.Select,{value:eA.protocol,onValueChange:e=>eD(t=>({...t,protocol:e})),children:[(0,t.jsx)(h.SelectTrigger,{className:"w-32",children:(0,t.jsx)(h.SelectValue,{placeholder:"Protocol"})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(h.SelectItem,{value:"tcp",children:"TCP"}),(0,t.jsx)(h.SelectItem,{value:"udp",children:"UDP"})]})]}),(0,t.jsxs)(h.Select,{value:eA.state,onValueChange:e=>eD(t=>({...t,state:e})),children:[(0,t.jsx)(h.SelectTrigger,{className:"w-40",children:(0,t.jsx)(h.SelectValue,{placeholder:"State"})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"all",children:"All States"}),(0,t.jsx)(h.SelectItem,{value:"ESTABLISHED",children:"Established"}),(0,t.jsx)(h.SelectItem,{value:"LISTEN",children:"Listening"}),(0,t.jsx)(h.SelectItem,{value:"TIME-WAIT",children:"Time Wait"})]})]})]})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border/50",children:[(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Protocol"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Local Address"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Remote Address"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"State"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Process"})]})}),(0,t.jsx)("tbody",{children:$.slice(0,100).map((e,a)=>(0,t.jsxs)("tr",{className:"border-b border-border/30 hover:bg-muted/20",children:[(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)(d.Badge,{variant:"outline",children:e.protocol.toUpperCase()})}),(0,t.jsxs)("td",{className:"p-2 font-mono text-xs",children:[e.local_addr,":",e.local_port]}),(0,t.jsxs)("td",{className:"p-2 font-mono text-xs",children:[e.remote_addr,":",e.remote_port]}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)(d.Badge,{variant:"ESTAB"===e.state?"default":"secondary",className:"text-xs",children:e.state})}),(0,t.jsx)("td",{className:"p-2 text-xs",children:e.process?"".concat(e.process," (").concat(e.pid,")"):"-"})]},a))})]}),$.length>100&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:["Showing 100 of ",$.length," connections"]})]})})]})})]})]}),(0,t.jsx)(x.Dialog,{open:el,onOpenChange:en,children:(0,t.jsxs)(x.DialogContent,{children:[(0,t.jsxs)(x.DialogHeader,{children:[(0,t.jsxs)(x.DialogTitle,{children:["Add Service to ",null==eg?void 0:eg.name]}),(0,t.jsx)(x.DialogDescription,{children:"Allow a service through the firewall in this zone."})]}),(0,t.jsxs)("div",{className:"py-4",children:[(0,t.jsx)(c.Label,{children:"Service"}),(0,t.jsxs)(h.Select,{value:ev,onValueChange:eN,children:[(0,t.jsx)(h.SelectTrigger,{className:"mt-2",children:(0,t.jsx)(h.SelectValue,{placeholder:"Select a service"})}),(0,t.jsx)(h.SelectContent,{className:"max-h-60",children:W.filter(e=>!(null==eg?void 0:eg.services.includes(e))).map(e=>(0,t.jsx)(h.SelectItem,{value:e,children:e},e))})]})]}),(0,t.jsxs)(x.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>en(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:eE,disabled:!ev,children:"Add Service"})]})]})}),(0,t.jsx)(x.Dialog,{open:ei,onOpenChange:ec,children:(0,t.jsxs)(x.DialogContent,{children:[(0,t.jsxs)(x.DialogHeader,{children:[(0,t.jsxs)(x.DialogTitle,{children:["Add Port to ",null==eg?void 0:eg.name]}),(0,t.jsx)(x.DialogDescription,{children:"Open a port in this firewall zone."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Port Number"}),(0,t.jsx)(i.Input,{type:"number",min:1,max:65535,placeholder:"e.g., 8080",value:eb.port,onChange:e=>ew(t=>({...t,port:e.target.value})),className:"mt-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Protocol"}),(0,t.jsxs)(h.Select,{value:eb.protocol,onValueChange:e=>ew(t=>({...t,protocol:e})),children:[(0,t.jsx)(h.SelectTrigger,{className:"mt-2",children:(0,t.jsx)(h.SelectValue,{})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"tcp",children:"TCP"}),(0,t.jsx)(h.SelectItem,{value:"udp",children:"UDP"})]})]})]})]}),(0,t.jsxs)(x.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>ec(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:eM,disabled:!eb.port,children:"Add Port"})]})]})}),(0,t.jsx)(x.Dialog,{open:eo,onOpenChange:ed,children:(0,t.jsxs)(x.DialogContent,{children:[(0,t.jsxs)(x.DialogHeader,{children:[(0,t.jsx)(x.DialogTitle,{children:"Add Static Route"}),(0,t.jsx)(x.DialogDescription,{children:"Add a new route to the routing table."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Destination (CIDR)"}),(0,t.jsx)(i.Input,{placeholder:"e.g., 10.0.0.0/8",value:ey.destination,onChange:e=>eC(t=>({...t,destination:e.target.value})),className:"mt-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Gateway (optional)"}),(0,t.jsx)(i.Input,{placeholder:"e.g., 192.168.1.1",value:ey.gateway,onChange:e=>eC(t=>({...t,gateway:e.target.value})),className:"mt-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Interface (optional)"}),(0,t.jsxs)(h.Select,{value:ey.interface,onValueChange:e=>eC(t=>({...t,interface:e})),children:[(0,t.jsx)(h.SelectTrigger,{className:"mt-2",children:(0,t.jsx)(h.SelectValue,{placeholder:"Select interface"})}),(0,t.jsx)(h.SelectContent,{children:O.map(e=>(0,t.jsx)(h.SelectItem,{value:e.name,children:e.name},e.name))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Metric (optional)"}),(0,t.jsx)(i.Input,{type:"number",min:0,placeholder:"0",value:ey.metric||"",onChange:e=>eC(t=>({...t,metric:parseInt(e.target.value)||0})),className:"mt-2"})]})]}),(0,t.jsxs)(x.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>ed(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:eL,disabled:!ey.destination,children:"Add Route"})]})]})}),(0,t.jsx)(m.AlertDialog,{open:ex,onOpenChange:eh,children:(0,t.jsxs)(m.AlertDialogContent,{children:[(0,t.jsxs)(m.AlertDialogHeader,{children:[(0,t.jsxs)(m.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(B.AlertTriangle,{className:"w-5 h-5 text-destructive"}),"Confirm Deletion"]}),(0,t.jsxs)(m.AlertDialogDescription,{children:["Are you sure you want to delete this ",ek.type,"? This action may affect network connectivity."]})]}),(0,t.jsxs)(m.AlertDialogFooter,{children:[(0,t.jsx)(m.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(m.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:eO,children:"Delete"})]})]})}),(0,t.jsx)(x.Dialog,{open:em,onOpenChange:eu,children:(0,t.jsxs)(x.DialogContent,{children:[(0,t.jsx)(x.DialogHeader,{children:(0,t.jsx)(x.DialogTitle,{className:ej.success?"text-green-500":"text-destructive",children:ej.success?"Success":"Error"})}),(0,t.jsx)("div",{className:"py-4",children:(0,t.jsx)("p",{children:ej.message})}),(0,t.jsx)(x.DialogFooter,{children:(0,t.jsx)(n.Button,{onClick:()=>eu(!1),children:"Close"})})]})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsx)(j.Activity,{className:"w-12 h-12 text-accent animate-pulse"})})}}]);