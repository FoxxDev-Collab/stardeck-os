(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,44834,e=>{"use strict";e.s(["default",()=>W],44834);var s=e.i(43476),t=e.i(71645),a=e.i(18566),r=e.i(91432),l=e.i(17995),n=e.i(48654),o=e.i(67881),i=e.i(23750),c=e.i(10708),d=e.i(70065),m=e.i(27341),h=e.i(62870),u=e.i(19036),x=e.i(94179),p=e.i(71435),g=e.i(30374),j=e.i(78094),v=e.i(7233),f=e.i(63209),N=e.i(25913),b=e.i(47163);let y=(0,N.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function C(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,b.cn)(y({variant:a}),t),...r})}function w(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,b.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}let S=[{port:"80",name:"HTTP",protocol:"tcp"},{port:"443",name:"HTTPS",protocol:"tcp"},{port:"3000",name:"Dev Server",protocol:"tcp"},{port:"8080",name:"Alt HTTP",protocol:"tcp"},{port:"5432",name:"PostgreSQL",protocol:"tcp"},{port:"3306",name:"MySQL",protocol:"tcp"},{port:"6379",name:"Redis",protocol:"tcp"},{port:"27017",name:"MongoDB",protocol:"tcp"},{port:"9000",name:"SonarQube",protocol:"tcp"},{port:"8443",name:"Alt HTTPS",protocol:"tcp"}];function k(e){var a;let{ports:l,onPortsChange:n}=e,{token:d}=(0,r.useAuth)(),[m,u]=(0,t.useState)([]),[p,g]=(0,t.useState)(""),[N,b]=(0,t.useState)(""),[y,k]=(0,t.useState)("tcp");(0,t.useEffect)(()=>{(async()=>{if(d)try{let e=await fetch("/api/ports/used",{headers:{Authorization:"Bearer ".concat(d)}});if(e.ok){let s=await e.json();u(s||[])}}catch(e){console.error("Failed to fetch used ports:",e)}})()},[d]);let P=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tcp";return m.some(t=>t.port===parseInt(e)&&t.protocol===s)},_=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tcp";return m.find(t=>t.port===parseInt(e)&&t.protocol===s)};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"mb-2 block",children:"Common Ports"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:S.map(e=>{let t=P(e.port,e.protocol),a=_(e.port,e.protocol);return(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsxs)(o.Button,{variant:t?"secondary":"outline",size:"sm",onClick:()=>{var s,t;!P(s=e.port,t=e.protocol)&&n([...l,{hostPort:s,containerPort:s,protocol:t}])},disabled:t,className:t?"opacity-50":"",children:[e.port," (",e.name,")"]}),t&&a&&(0,s.jsx)("div",{className:"absolute bottom-full left-0 mb-2 hidden group-hover:block z-10 w-48",children:(0,s.jsxs)("div",{className:"bg-popover border rounded-lg shadow-lg p-2 text-xs",children:[(0,s.jsx)("p",{className:"font-semibold",children:"In use by:"}),(0,s.jsx)("p",{className:"text-muted-foreground truncate",children:a.container_name||a.container_id})]})})]},"".concat(e.port,"-").concat(e.protocol))})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,s.jsxs)("div",{className:"col-span-4 space-y-2",children:[(0,s.jsx)(c.Label,{children:"Host Port"}),(0,s.jsx)(i.Input,{type:"number",placeholder:"8080",value:p,onChange:e=>g(e.target.value)}),p&&P(p,y)&&(0,s.jsxs)(C,{variant:"destructive",className:"mt-2",children:[(0,s.jsx)(f.AlertCircle,{className:"h-4 w-4"}),(0,s.jsxs)(w,{className:"text-xs",children:["Port ",p,"/",y," is already in use by"," ",null==(a=_(p,y))?void 0:a.container_name]})]})]}),(0,s.jsxs)("div",{className:"col-span-4 space-y-2",children:[(0,s.jsx)(c.Label,{children:"Container Port"}),(0,s.jsx)(i.Input,{type:"number",placeholder:"80",value:N,onChange:e=>b(e.target.value)})]}),(0,s.jsxs)("div",{className:"col-span-2 space-y-2",children:[(0,s.jsx)(c.Label,{children:"Protocol"}),(0,s.jsxs)(h.Select,{value:y,onValueChange:e=>k(e),children:[(0,s.jsx)(h.SelectTrigger,{children:(0,s.jsx)(h.SelectValue,{})}),(0,s.jsxs)(h.SelectContent,{children:[(0,s.jsx)(h.SelectItem,{value:"tcp",children:"TCP"}),(0,s.jsx)(h.SelectItem,{value:"udp",children:"UDP"})]})]})]}),(0,s.jsxs)("div",{className:"col-span-2 space-y-2",children:[(0,s.jsx)(c.Label,{className:"invisible",children:"Add"}),(0,s.jsx)(o.Button,{onClick:()=>{p&&N&&(n([...l,{hostPort:p,containerPort:N,protocol:y}]),g(""),b(""))},className:"w-full",children:(0,s.jsx)(v.Plus,{className:"h-4 w-4"})})]})]}),l.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Configured Ports"}),(0,s.jsx)("div",{className:"space-y-2",children:l.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(j.Network,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("span",{className:"font-mono text-sm",children:[e.hostPort," → ",e.containerPort]}),(0,s.jsx)(x.Badge,{variant:"secondary",children:e.protocol.toUpperCase()})]}),(0,s.jsx)(o.Button,{variant:"ghost",size:"icon",onClick:()=>{n(l.filter((e,s)=>s!==t))},children:(0,s.jsx)("span",{className:"h-4 w-4",children:"×"})})]},t))})]})]})}let P=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var _=e.i(55436),T=e.i(27612),I=e.i(40160),L=e.i(69074),A=e.i(78583),E=e.i(52786),B=e.i(39616),H=e.i(31343),D=e.i(52571),O=e.i(78917),V=e.i(95468),M=e.i(73884),F=e.i(31278),R=e.i(68054),z=e.i(48256);function U(){let e=(0,a.useRouter)(),N=(0,a.useSearchParams)(),{token:b}=(0,r.useAuth)(),{settings:y}=(0,l.useSettings)(),C=(0,t.useRef)(null),w=N.get("edit"),S=!!w,[U,W]=(0,t.useState)(!1),[G,q]=(0,t.useState)(""),[J,K]=(0,t.useState)(""),[X,Q]=(0,t.useState)(""),[Y,Z]=(0,t.useState)("latest"),[$,ee]=(0,t.useState)(y.container.autoStartContainers),[es,et]=(0,t.useState)(y.container.enablePrivilegedByDefault),[ea,er]=(0,t.useState)(y.container.defaultNetworkMode),[el,en]=(0,t.useState)(y.container.defaultRestartPolicy),[eo,ei]=(0,t.useState)(""),[ec,ed]=(0,t.useState)([]),[em,eh]=(0,t.useState)(!1),[eu,ex]=(0,t.useState)([]),[ep,eg]=(0,t.useState)([]),[ej,ev]=(0,t.useState)("volume"),[ef,eN]=(0,t.useState)(""),[eb,ey]=(0,t.useState)(""),[eC,ew]=(0,t.useState)(""),[eS,ek]=(0,t.useState)(!1),[eP,e_]=(0,t.useState)([]),[eT,eI]=(0,t.useState)([]),[eL,eA]=(0,t.useState)(""),[eE,eB]=(0,t.useState)(""),[eH,eD]=(0,t.useState)(""),[eO,eV]=(0,t.useState)(""),[eM,eF]=(0,t.useState)(""),[eR,ez]=(0,t.useState)(""),[eU,eW]=(0,t.useState)(""),[eG,eq]=(0,t.useState)(""),[eJ,eK]=(0,t.useState)(""),[eX,eQ]=(0,t.useState)(!1),[eY,eZ]=(0,t.useState)(""),[e$,e0]=(0,t.useState)("/"),[e4,e2]=(0,t.useState)(""),[e1,e5]=(0,t.useState)(!1),[e3,e8]=(0,t.useState)(null),[e7,e6]=(0,t.useState)([]),[e9,se]=(0,t.useState)(!1),[ss,st]=(0,t.useState)(!1),[sa,sr]=(0,t.useState)([]),[sl,sn]=(0,t.useState)([]),[so,si]=(0,t.useState)(!1),[sc,sd]=(0,t.useState)(!1),[sm,sh]=(0,t.useState)(!1),[su,sx]=(0,t.useState)(!1),[sp,sg]=(0,t.useState)(""),[sj,sv]=(0,t.useState)([]),[sf,sN]=(0,t.useState)(null),[sb,sy]=(0,t.useState)(null),sC=(0,t.useRef)(null);(0,t.useEffect)(()=>{(async()=>{if(b)try{let e=await fetch("/api/volumes",{headers:{Authorization:"Bearer ".concat(b)}});if(e.ok){let s=await e.json();e_(s||[])}}catch(e){console.error("Failed to fetch volumes:",e)}})()},[b]),(0,t.useEffect)(()=>{C.current&&(C.current.scrollTop=C.current.scrollHeight)},[sl,sa]),(0,t.useEffect)(()=>{sC.current&&(sC.current.scrollTop=sC.current.scrollHeight)},[sj]),(0,t.useEffect)(()=>{w&&b&&(async()=>{W(!0),e8(null);try{var e,s;let t=await fetch("/api/containers/".concat(w),{headers:{Authorization:"Bearer ".concat(b)}});if(!t.ok)throw Error("Failed to load container configuration");let a=await t.json(),r=(null==(e=a.name)?void 0:e.replace(/^\//,""))||"";K(r),q(r);let l=a.image||"",n=l.lastIndexOf(":");if(n>0&&!l.substring(n).includes("/")?(Q(l.substring(0,n)),Z(l.substring(n+1))):(Q(l),Z("latest")),(null==(s=a.restart_policy)?void 0:s.name)&&en(a.restart_policy.name),a.network_mode&&er(a.network_mode),a.hostname&&eW(a.hostname),a.user&&ez(a.user),a.working_dir&&eF(a.working_dir),a.env&&Array.isArray(a.env)){let e=new Set(["PATH","HOME","HOSTNAME","TERM"]),s=a.env.map(e=>{let s=e.indexOf("=");return s>0?{key:e.substring(0,s),value:e.substring(s+1)}:null}).filter(s=>null!==s&&!e.has(s.key));eI(s)}if(a.port_bindings){let e=[];for(let[s,t]of Object.entries(a.port_bindings)){let[a,r]=s.split("/");if(Array.isArray(t))for(let s of t)e.push({hostPort:s.HostPort||a,containerPort:a,protocol:r||"tcp"})}ex(e)}if(a.mounts&&Array.isArray(a.mounts)){let e=a.mounts.filter(e=>"bind"===e.Type||"volume"===e.Type).map(e=>({type:"volume"===e.Type?"volume":"bind",hostPath:"bind"===e.Type&&e.Source||"",volumeName:"volume"===e.Type&&e.Source||"",containerPath:e.Destination||"",readOnly:!e.RW}));eg(e)}if(a.cmd&&Array.isArray(a.cmd)&&a.cmd.length>0&&eD(a.cmd.join(" ")),a.entrypoint&&Array.isArray(a.entrypoint)&&a.entrypoint.length>0&&eV(a.entrypoint.join(" ")),a.memory_limit&&a.memory_limit>0){let e=Math.round(a.memory_limit/1048576);eK("".concat(e,"m"))}void 0!==a.auto_start&&ee(a.auto_start),void 0!==a.has_web_ui&&eQ(a.has_web_ui),a.web_ui_port&&eZ(String(a.web_ui_port)),a.web_ui_path&&e0(a.web_ui_path),a.icon&&e2(a.icon)}catch(e){e8(e instanceof Error?e.message:"Failed to load container")}finally{W(!1)}})()},[w,b]),(0,t.useEffect)(()=>{let e=setTimeout(async()=>{if(!b||!X)return void e6([]);se(!0);try{let e=sw(),s=await fetch("/api/containers/validate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(b)},body:JSON.stringify(e)});if(s.ok){let e=await s.json();e6(e.results||[])}}catch(e){console.error("Validation error:",e)}finally{se(!1)}},500);return()=>clearTimeout(e)},[b,X,Y,J,eu]);let sw=()=>({name:J||void 0,image:Y?"".concat(X,":").concat(Y):X,auto_start:$,privileged:es,network_mode:ea,restart_policy:el,ports:eu.map(e=>({host_port:parseInt(e.hostPort),container_port:parseInt(e.containerPort),protocol:e.protocol})),volumes:ep.map(e=>({type:e.type,source:"bind"===e.type?e.hostPath:e.volumeName,target:e.containerPath,read_only:e.readOnly})),environment:eT.reduce((e,s)=>(e[s.key]=s.value,e),{}),command:eH?eH.split(" "):void 0,entrypoint:eO?eO.split(" "):void 0,work_dir:eM||void 0,user:eR||void 0,hostname:eU||void 0,cpu_limit:eG?parseFloat(eG):void 0,memory_limit:eJ?1024*parseInt(eJ)*1024:void 0,has_web_ui:eX,web_ui_port:eX&&eY?parseInt(eY):void 0,web_ui_path:eX?e$||"/":void 0,icon:e4||void 0}),sS=async()=>{if(!X)return void e8("Please specify an image");if(e7.some(e=>"error"===e.status))return void e8("Please fix validation errors before deploying");if(st(!0),sr([]),sn([]),si(!1),sd(!1),S&&w){sr([{step:"replace",message:"Stopping old container...",error:!1}]);try{if(await fetch("/api/containers/".concat(w,"/stop"),{method:"POST",headers:{Authorization:"Bearer ".concat(b)}}),sr([{step:"replace",message:"Removing old container...",error:!1}]),!(await fetch("/api/containers/".concat(w,"?force=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(b)}})).ok)throw Error("Failed to remove old container");sr([{step:"replace",message:"Old container removed",error:!1,complete:!0}])}catch(e){sr(s=>[...s,{step:"replace",message:"Failed to replace container: ".concat(e instanceof Error?e.message:"Unknown error"),error:!0}]),sd(!0);return}}let e="https:"===window.location.protocol?"wss:":"ws:",s=new WebSocket("".concat(e,"//").concat(window.location.host,"/api/containers/deploy"));s.onopen=()=>{s.send(JSON.stringify(sw()))},s.onmessage=e=>{try{let s=JSON.parse(e.data);s.output?sn(e=>[...e,s.message]):(sr(e=>e.find(e=>e.step===s.step)?e.map(e=>e.step===s.step?s:e):[...e,s]),s.error&&sd(!0),"complete"===s.step&&s.complete&&si(!0))}catch(e){console.error("WebSocket message parse error:",e)}},s.onerror=()=>{sr(e=>[...e,{step:"error",message:"WebSocket connection failed",error:!0}]),sd(!0)},s.onclose=()=>{so||sc||sr(e=>[...e,{step:"error",message:"Connection closed unexpectedly",error:!0}])}},sk=(0,t.useCallback)(async e=>{if(!e.trim()||!b)return void ed([]);eh(!0);try{let s=await fetch("/api/dockerhub/search?query=".concat(encodeURIComponent(e),"&page_size=10"),{headers:{Authorization:"Bearer ".concat(b)}});if(!s.ok)throw Error("Failed to search Docker Hub");let t=await s.json();ed(t.results||[])}catch(e){console.error("Docker Hub search error:",e),ed([])}finally{eh(!1)}},[b]);return(0,t.useEffect)(()=>{let e=setTimeout(()=>{sk(eo)},500);return()=>clearTimeout(e)},[eo,sk]),(0,s.jsxs)(n.DashboardLayout,{children:[(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(o.Button,{variant:"ghost",size:"icon",onClick:()=>e.push("/container-manager"),children:(0,s.jsx)(P,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:S?"Edit Container":"Create Container"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:S?"Editing ".concat(G||"container"," - changes will recreate the container"):"Deploy a new container with custom configuration"})]}),U&&(0,s.jsx)(F.Loader2,{className:"h-5 w-5 animate-spin text-muted-foreground"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>e.push("/container-manager"),children:"Cancel"}),(0,s.jsxs)(o.Button,{onClick:sS,disabled:e9||U||!X||e7.some(e=>"error"===e.status),children:[(0,s.jsx)(H.Play,{className:"h-4 w-4 mr-2"}),S?"Update Container":"Deploy Container"]})]})]}),e3&&(0,s.jsx)("div",{className:"mx-6 mt-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg text-destructive",children:e3}),e7.some(e=>"error"===e.status)&&(0,s.jsxs)("div",{className:"mx-6 mt-4 p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-amber-500 font-medium mb-2",children:[(0,s.jsx)(f.AlertCircle,{className:"h-4 w-4"}),"Configuration Issues"]}),(0,s.jsx)("ul",{className:"text-sm text-amber-400 space-y-1",children:e7.filter(e=>"error"===e.status).map((e,t)=>(0,s.jsxs)("li",{children:["• ",e.message,": ",e.details]},t))})]}),(0,s.jsx)(p.ScrollArea,{className:"flex-1",children:(0,s.jsxs)("div",{className:"p-6 max-w-6xl mx-auto space-y-6",children:[(0,s.jsxs)(d.Card,{children:[(0,s.jsxs)(d.CardHeader,{children:[(0,s.jsx)(d.CardTitle,{children:"Container Image"}),(0,s.jsx)(d.CardDescription,{children:"Select or search for a Docker image from Docker Hub"})]}),(0,s.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(_.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(i.Input,{placeholder:"Search Docker Hub (e.g., nginx, postgres, redis)...",value:eo,onChange:e=>ei(e.target.value),className:"pl-9"}),em&&(0,s.jsx)("div",{className:"absolute right-3 top-3 text-xs text-muted-foreground",children:"Searching..."})]}),ec.length>0&&(0,s.jsxs)(d.Card,{className:"border-dashed",children:[(0,s.jsx)(d.CardHeader,{className:"pb-3",children:(0,s.jsx)(d.CardTitle,{className:"text-sm",children:"Search Results"})}),(0,s.jsx)(d.CardContent,{className:"space-y-2",children:ec.map((e,t)=>(0,s.jsxs)("button",{type:"button",className:"w-full flex items-start justify-between p-3 rounded-lg border bg-card hover:bg-accent cursor-pointer transition-colors group text-left",onClick:()=>{console.log("Clicked image:",e.repo_name),console.log("Selecting image:",e),Q(e.repo_name),ei(""),ed([])},children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"font-semibold group-hover:text-primary transition-colors",children:e.repo_name}),e.is_official&&(0,s.jsx)(x.Badge,{variant:"default",className:"text-xs",children:"Official"}),e.is_automated&&(0,s.jsx)(x.Badge,{variant:"secondary",className:"text-xs",children:"Automated"}),!e.is_official&&e.repo_owner&&(0,s.jsxs)(x.Badge,{variant:"outline",className:"text-xs",children:["by ",e.repo_owner]})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.short_description||"No description available"}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[(0,s.jsxs)("span",{children:["★ ",e.star_count.toLocaleString()]}),(0,s.jsxs)("span",{children:["↓ ",e.pull_count.toLocaleString()," pulls"]})]})]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground group-hover:text-primary transition-colors",children:"Click to select →"})]},t))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Image Name"}),(0,s.jsx)(i.Input,{placeholder:"e.g., nginx, postgres, myapp",value:X,onChange:e=>Q(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Tag"}),(0,s.jsx)(i.Input,{placeholder:"latest",value:Y,onChange:e=>Z(e.target.value)})]})]}),X&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)(D.Info,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("span",{className:"text-sm",children:["Will pull: ",(0,s.jsxs)("code",{className:"px-1.5 py-0.5 bg-background rounded",children:[X,":",Y]})]}),(0,s.jsxs)("a",{href:"https://hub.docker.com/r/".concat(X),target:"_blank",rel:"noopener noreferrer",className:"ml-auto text-xs text-primary hover:underline flex items-center gap-1",children:["View on Docker Hub",(0,s.jsx)(O.ExternalLink,{className:"h-3 w-3"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-accent/10 border border-accent/20 rounded-lg",children:[(0,s.jsx)(I.Download,{className:"h-4 w-4 text-accent"}),(0,s.jsx)("span",{className:"text-sm flex-1",children:"Pull image to auto-detect ports, volumes, and environment variables"}),(0,s.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>(e=>{if(!X)return void e8("Please enter an image name first");sh(!0),sx(!0),sg("connecting"),sv([]),sN(null),sy(null);let s="https:"===window.location.protocol?"wss:":"ws:",t=new WebSocket("".concat(s,"//").concat(window.location.host,"/api/images/inspect/ws"));t.onopen=()=>{let s=Y?"".concat(X,":").concat(Y):X;t.send(JSON.stringify({image:s,pull:e}))},t.onmessage=e=>{try{let s=JSON.parse(e.data);if(s.error){sg("error"),sv(e=>[...e,"Error: ".concat(s.error)]),sx(!1);return}"pulling"===s.status?(sg("pulling"),s.output?sv(e=>[...e,s.output]):s.message&&sv(e=>[...e,s.message])):"pulled"===s.status?sv(e=>[...e,"✓ Image pulled successfully"]):"inspecting"===s.status?(sg("inspecting"),sv(e=>[...e,"Analyzing image configuration..."])):"complete"===s.status?(sg("complete"),sy(s.found),s.config&&(sN(s.config),sv(e=>[...e,"✓ Image configuration loaded"])),sx(!1)):"not_found"===s.status&&(sg("not_found"),sy(!1),sx(!1))}catch(e){console.error("WebSocket message parse error:",e)}},t.onerror=()=>{sg("error"),sv(e=>[...e,"WebSocket connection failed"]),sx(!1)},t.onclose=()=>{su&&sx(!1)}})(!0),disabled:su,children:su?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Inspecting..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.Search,{className:"h-4 w-4 mr-2"}),"Pull & Inspect"]})})]})]})]})]}),(0,s.jsxs)(m.Tabs,{defaultValue:"basic",className:"w-full",children:[(0,s.jsxs)(m.TabsList,{className:"grid w-full grid-cols-5",children:[(0,s.jsx)(m.TabsTrigger,{value:"basic",children:"Basic"}),(0,s.jsx)(m.TabsTrigger,{value:"ports",children:"Ports"}),(0,s.jsx)(m.TabsTrigger,{value:"volumes",children:"Volumes"}),(0,s.jsx)(m.TabsTrigger,{value:"env",children:"Environment"}),(0,s.jsx)(m.TabsTrigger,{value:"advanced",children:"Advanced"})]}),(0,s.jsx)(m.TabsContent,{value:"basic",className:"space-y-4",children:(0,s.jsxs)(d.Card,{children:[(0,s.jsxs)(d.CardHeader,{children:[(0,s.jsx)(d.CardTitle,{children:"Basic Configuration"}),(0,s.jsx)(d.CardDescription,{children:"Configure basic container settings"})]}),(0,s.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Container Name (optional)"}),(0,s.jsx)(i.Input,{placeholder:"my-container",value:J,onChange:e=>K(e.target.value)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"If not specified, a random name will be generated"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Network Mode"}),(0,s.jsxs)(h.Select,{value:ea,onValueChange:er,children:[(0,s.jsx)(h.SelectTrigger,{children:(0,s.jsx)(h.SelectValue,{})}),(0,s.jsxs)(h.SelectContent,{children:[(0,s.jsx)(h.SelectItem,{value:"bridge",children:"Bridge"}),(0,s.jsx)(h.SelectItem,{value:"host",children:"Host"}),(0,s.jsx)(h.SelectItem,{value:"none",children:"None"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Restart Policy"}),(0,s.jsxs)(h.Select,{value:el,onValueChange:en,children:[(0,s.jsx)(h.SelectTrigger,{children:(0,s.jsx)(h.SelectValue,{})}),(0,s.jsxs)(h.SelectContent,{children:[(0,s.jsx)(h.SelectItem,{value:"no",children:"No"}),(0,s.jsx)(h.SelectItem,{value:"always",children:"Always"}),(0,s.jsx)(h.SelectItem,{value:"unless-stopped",children:"Unless Stopped"}),(0,s.jsx)(h.SelectItem,{value:"on-failure",children:"On Failure"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(c.Label,{children:"Auto-start container"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start the container immediately after creation"})]}),(0,s.jsx)(u.Switch,{checked:$,onCheckedChange:ee})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(c.Label,{children:"Privileged mode"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Grant extended privileges (use with caution)"})]}),(0,s.jsx)(u.Switch,{checked:es,onCheckedChange:et})]}),(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)(z.Globe,{className:"h-4 w-4 text-cyan-400"}),(0,s.jsx)(c.Label,{className:"text-base font-semibold",children:"Desktop App Settings"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(c.Label,{children:"Has Web UI"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enable to show as desktop app with icon"})]}),(0,s.jsx)(u.Switch,{checked:eX,onCheckedChange:eQ})]}),eX&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Web UI Port"}),(0,s.jsxs)(h.Select,{value:eY,onValueChange:eZ,children:[(0,s.jsx)(h.SelectTrigger,{children:(0,s.jsx)(h.SelectValue,{placeholder:"Select port"})}),(0,s.jsx)(h.SelectContent,{children:eu.length>0?eu.map((e,t)=>(0,s.jsxs)(h.SelectItem,{value:e.hostPort,children:[e.hostPort," → ",e.containerPort,"/",e.protocol]},t)):(0,s.jsx)(h.SelectItem,{value:"",disabled:!0,children:"Add ports first"})})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Host port that serves the web interface"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Web UI Path"}),(0,s.jsx)(i.Input,{placeholder:"/",value:e$,onChange:e=>e0(e.target.value)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:'Path prefix (usually "/")'})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Icon Name"}),(0,s.jsx)(i.Input,{placeholder:"jellyfin, gitea, nextcloud...",value:e4,onChange:e=>e2(e.target.value)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used for desktop icon display"})]})]})]})]})]})]})}),(0,s.jsx)(m.TabsContent,{value:"ports",className:"space-y-4",children:(0,s.jsxs)(d.Card,{children:[(0,s.jsxs)(d.CardHeader,{children:[(0,s.jsx)(d.CardTitle,{children:"Port Mappings"}),(0,s.jsx)(d.CardDescription,{children:"Expose container ports to the host. Ports in use are highlighted."})]}),(0,s.jsx)(d.CardContent,{children:(0,s.jsx)(k,{ports:eu,onPortsChange:ex})})]})}),(0,s.jsx)(m.TabsContent,{value:"volumes",className:"space-y-4",children:(0,s.jsxs)(d.Card,{children:[(0,s.jsxs)(d.CardHeader,{children:[(0,s.jsx)(d.CardTitle,{children:"Volume Mounts"}),(0,s.jsx)(d.CardDescription,{children:"Mount Podman volumes or host directories into the container. Podman volumes are recommended for better isolation and portability."})]}),(0,s.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,s.jsx)("div",{className:"p-3 bg-accent/10 border border-accent/20 rounded-lg text-sm",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(D.Info,{className:"h-4 w-4 text-accent mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-accent",children:"Volume Types"}),(0,s.jsxs)("ul",{className:"mt-1 text-muted-foreground text-xs space-y-1",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Podman Volume"})," (recommended): Managed storage, better isolation, portable"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Bind Mount"}),": Direct host directory access, for config files or shared data"]})]})]})]})}),(0,s.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/30",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Volume Type"}),(0,s.jsxs)(h.Select,{value:ej,onValueChange:e=>ev(e),children:[(0,s.jsx)(h.SelectTrigger,{children:(0,s.jsx)(h.SelectValue,{})}),(0,s.jsxs)(h.SelectContent,{children:[(0,s.jsx)(h.SelectItem,{value:"volume",children:"Podman Volume"}),(0,s.jsx)(h.SelectItem,{value:"bind",children:"Bind Mount"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Container Path"}),(0,s.jsx)(i.Input,{placeholder:"/container/path",value:eC,onChange:e=>ew(e.target.value)})]})]}),"volume"===ej?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Volume Name"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Input,{placeholder:"my-volume (will be created if it doesn't exist)",value:ef,onChange:e=>eN(e.target.value),className:"flex-1"}),eP.length>0&&(0,s.jsxs)(h.Select,{onValueChange:e=>eN(e),children:[(0,s.jsx)(h.SelectTrigger,{className:"w-48",children:(0,s.jsx)(h.SelectValue,{placeholder:"Or select..."})}),(0,s.jsx)(h.SelectContent,{children:eP.map(e=>(0,s.jsx)(h.SelectItem,{value:e.name,children:e.name},e.name))})]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter a name for a new volume or select an existing one"})]}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Host Path"}),(0,s.jsx)(i.Input,{placeholder:"/path/on/host",value:eb,onChange:e=>ey(e.target.value)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Absolute path to directory on the host system"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(c.Label,{children:"Read-only mount"}),(0,s.jsx)(u.Switch,{checked:eS,onCheckedChange:ek})]}),(0,s.jsxs)(o.Button,{onClick:()=>{var e;(e="volume"===ej?ef:eb)&&eC&&(eg([...ep,{type:ej,hostPath:"bind"===ej?e:"",volumeName:"volume"===ej?e:"",containerPath:eC,readOnly:eS}]),ey(""),ew(""),ek(!1),eN(""),ev("volume"))},className:"w-full",disabled:!eC||("volume"===ej?!ef:!eb),children:[(0,s.jsx)(v.Plus,{className:"h-4 w-4 mr-2"}),"Add Volume"]})]}),ep.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{children:["Configured Volumes (",ep.length,")"]}),(0,s.jsx)("div",{className:"space-y-2",children:ep.map((e,t)=>(0,s.jsxs)("div",{className:"p-3 rounded-lg border ".concat(("bind"!==e.type||e.hostPath)&&("volume"!==e.type||e.volumeName)?"bg-card":"border-amber-500/50 bg-amber-500/5"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(E.HardDrive,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,s.jsx)(x.Badge,{variant:"volume"===e.type?"default":"secondary",className:"text-xs",children:"volume"===e.type?"Podman Volume":"Bind Mount"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground flex-1",children:"→"}),(0,s.jsx)("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:e.containerPath}),e.readOnly&&(0,s.jsx)(x.Badge,{variant:"outline",className:"flex-shrink-0 text-xs",children:"RO"}),(0,s.jsx)(o.Button,{variant:"ghost",size:"icon",onClick:()=>{eg(ep.filter((e,s)=>s!==t))},className:"h-6 w-6",children:(0,s.jsx)(T.Trash2,{className:"h-3 w-3"})})]}),"volume"===e.type?(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(i.Input,{placeholder:"Enter volume name (required)",value:e.volumeName,onChange:e=>{let s=[...ep];s[t]={...s[t],volumeName:e.target.value},eg(s)},className:"font-mono text-sm ".concat(e.volumeName?"":"border-amber-500/50")})}):(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(i.Input,{placeholder:"Enter host path (required)",value:e.hostPath,onChange:e=>{let s=[...ep];s[t]={...s[t],hostPath:e.target.value},eg(s)},className:"font-mono text-sm ".concat(e.hostPath?"":"border-amber-500/50")})}),"bind"===e.type&&!e.hostPath&&(0,s.jsx)("p",{className:"text-xs text-amber-500 mt-1",children:"Host path required - enter the directory on your server"}),"volume"===e.type&&!e.volumeName&&(0,s.jsx)("p",{className:"text-xs text-amber-500 mt-1",children:"Volume name required"})]},t))})]})]})]})}),(0,s.jsx)(m.TabsContent,{value:"env",className:"space-y-4",children:(0,s.jsxs)(d.Card,{children:[(0,s.jsxs)(d.CardHeader,{children:[(0,s.jsx)(d.CardTitle,{children:"Environment Variables"}),(0,s.jsx)(d.CardDescription,{children:"Set environment variables for the container"})]}),(0,s.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("env-file-input"))?void 0:e.click()},children:[(0,s.jsx)(L.Upload,{className:"h-4 w-4 mr-2"}),"Import .env"]}),(0,s.jsx)("input",{id:"env-file-input",type:"file",accept:".env,.txt",className:"hidden",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(!t)return;let a=new FileReader;a.onload=e=>{var s;let t=(null==(s=e.target)?void 0:s.result).split("\n"),a=[];t.forEach(e=>{let s=e.trim();if(s&&!s.startsWith("#")){let[e,...t]=s.split("=");e&&t.length>0&&a.push({key:e.trim(),value:t.join("=").trim().replace(/^["']|["']$/g,"")})}}),eI([...eT,...a])},a.readAsText(t)}}),(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([eT.map(e=>"".concat(e.key,"=").concat(e.value)).join("\n")],{type:"text/plain"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="".concat(J||"container",".env"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},disabled:0===eT.length,children:[(0,s.jsx)(I.Download,{className:"h-4 w-4 mr-2"}),"Export .env"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,s.jsxs)("div",{className:"col-span-5 space-y-2",children:[(0,s.jsx)(c.Label,{children:"Key"}),(0,s.jsx)(i.Input,{placeholder:"DATABASE_URL",value:eL,onChange:e=>eA(e.target.value.toUpperCase())})]}),(0,s.jsxs)("div",{className:"col-span-5 space-y-2",children:[(0,s.jsx)(c.Label,{children:"Value"}),(0,s.jsx)(i.Input,{placeholder:"postgres://...",value:eE,onChange:e=>eB(e.target.value)})]}),(0,s.jsxs)("div",{className:"col-span-2 space-y-2",children:[(0,s.jsx)(c.Label,{className:"invisible",children:"Add"}),(0,s.jsx)(o.Button,{onClick:()=>{eL&&eE&&(eI([...eT,{key:eL,value:eE}]),eA(""),eB(""))},className:"w-full",children:(0,s.jsx)(v.Plus,{className:"h-4 w-4"})})]})]}),eT.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{children:["Environment Variables (",eT.length,")"]}),(0,s.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:eT.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg border bg-card",children:[(0,s.jsx)(A.FileText,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,s.jsx)(i.Input,{value:e.key,onChange:e=>{let s=[...eT];s[t]={...s[t],key:e.target.value.toUpperCase()},eI(s)},className:"font-mono text-sm w-40 flex-shrink-0",placeholder:"KEY"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"="}),(0,s.jsx)(i.Input,{value:e.value,onChange:e=>{let s=[...eT];s[t]={...s[t],value:e.target.value},eI(s)},className:"font-mono text-sm flex-1",placeholder:"value"}),(0,s.jsx)(o.Button,{variant:"ghost",size:"icon",onClick:()=>{eI(eT.filter((e,s)=>s!==t))},className:"flex-shrink-0 h-8 w-8",children:(0,s.jsx)(T.Trash2,{className:"h-4 w-4"})})]},t))})]})]})]})}),(0,s.jsx)(m.TabsContent,{value:"advanced",className:"space-y-4",children:(0,s.jsxs)(d.Card,{children:[(0,s.jsxs)(d.CardHeader,{children:[(0,s.jsx)(d.CardTitle,{children:"Advanced Configuration"}),(0,s.jsx)(d.CardDescription,{children:"Fine-tune container runtime settings"})]}),(0,s.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Command"}),(0,s.jsx)(i.Input,{placeholder:"Override default command",value:eH,onChange:e=>eD(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Entrypoint"}),(0,s.jsx)(i.Input,{placeholder:"Override default entrypoint",value:eO,onChange:e=>eV(e.target.value)})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Working Directory"}),(0,s.jsx)(i.Input,{placeholder:"/app",value:eM,onChange:e=>eF(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"User"}),(0,s.jsx)(i.Input,{placeholder:"1000:1000 or username",value:eR,onChange:e=>ez(e.target.value)})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Hostname"}),(0,s.jsx)(i.Input,{placeholder:"my-container",value:eU,onChange:e=>eW(e.target.value)})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"CPU Limit (cores)"}),(0,s.jsx)(i.Input,{type:"number",step:"0.1",placeholder:"1.5",value:eG,onChange:e=>eq(e.target.value)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Number of CPU cores (e.g., 1.5)"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{children:"Memory Limit (MB)"}),(0,s.jsx)(i.Input,{type:"number",placeholder:"512",value:eJ,onChange:e=>eK(e.target.value)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Maximum memory in megabytes"})]})]})]})]})})]})]})})]}),(0,s.jsx)(g.Dialog,{open:ss,onOpenChange:st,children:(0,s.jsxs)(g.DialogContent,{className:"max-w-2xl max-h-[80vh] overflow-hidden",children:[(0,s.jsx)(g.DialogHeader,{children:(0,s.jsx)(g.DialogTitle,{className:"flex items-center gap-2",children:so?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V.CheckCircle2,{className:"h-5 w-5 text-green-500"}),"Deployment Complete"]}):sc?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.XCircle,{className:"h-5 w-5 text-red-500"}),"Deployment Failed"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Loader2,{className:"h-5 w-5 animate-spin"}),"Deploying Container"]})})}),(0,s.jsx)("div",{className:"space-y-3 overflow-hidden",children:sa.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg border overflow-hidden ".concat(e.error?"bg-red-500/10 border-red-500/30":e.complete?"bg-green-500/10 border-green-500/30":"bg-muted/50 border-muted"),children:[e.error?(0,s.jsx)(M.XCircle,{className:"h-5 w-5 text-red-500 shrink-0 mt-0.5"}):e.complete?(0,s.jsx)(V.CheckCircle2,{className:"h-5 w-5 text-green-500 shrink-0 mt-0.5"}):(0,s.jsx)(F.Loader2,{className:"h-5 w-5 animate-spin text-primary shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,s.jsx)("div",{className:"font-medium capitalize",children:"replace"===e.step?"Replace":"validate"===e.step?"Validation":"pull"===e.step?"Image":"volumes"===e.step?"Volumes":"create"===e.step?"Create":"start"===e.step?"Start":"complete"===e.step?"Complete":e.step}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground break-words",children:e.message})]})]},t))}),sl.length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(c.Label,{className:"mb-2 block",children:"Output"}),(0,s.jsx)(p.ScrollArea,{className:"h-48 border rounded-lg bg-black/90 p-3",children:(0,s.jsx)("div",{ref:C,className:"font-mono text-xs text-green-400 space-y-0.5",children:sl.map((e,t)=>(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:e},t))})})]}),e7.length>0&&!so&&(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,s.jsx)(c.Label,{className:"mb-2 block",children:"Pre-flight Checks"}),e7.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start gap-2 p-2 rounded text-sm ".concat("error"===e.status?"bg-red-500/10 text-red-400":"warning"===e.status?"bg-yellow-500/10 text-yellow-400":"bg-green-500/10 text-green-400"),children:["error"===e.status?(0,s.jsx)(M.XCircle,{className:"h-4 w-4 shrink-0 mt-0.5"}):"warning"===e.status?(0,s.jsx)(f.AlertCircle,{className:"h-4 w-4 shrink-0 mt-0.5"}):(0,s.jsx)(V.CheckCircle2,{className:"h-4 w-4 shrink-0 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"font-medium",children:[e.check,":"]})," ",e.message,e.details&&(0,s.jsx)("div",{className:"text-xs opacity-75 mt-1",children:e.details})]})]},t))]}),(0,s.jsx)("div",{className:"flex justify-end gap-2 mt-4",children:so?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>st(!1),children:"Deploy Another"}),(0,s.jsxs)(o.Button,{onClick:()=>e.push("/container-manager"),children:[(0,s.jsx)(V.CheckCircle2,{className:"h-4 w-4 mr-2"}),"View Containers"]})]}):sc?(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>st(!1),children:"Close"}):null})]})}),(0,s.jsx)(g.Dialog,{open:sm,onOpenChange:e=>!su&&sh(e),children:(0,s.jsxs)(g.DialogContent,{className:"max-w-2xl max-h-[80vh] flex flex-col overflow-hidden",children:[(0,s.jsx)(g.DialogHeader,{className:"flex-shrink-0",children:(0,s.jsx)(g.DialogTitle,{className:"flex items-center gap-2",children:"complete"===sp?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V.CheckCircle2,{className:"h-5 w-5 text-green-500"}),"Image Configuration Loaded"]}):"error"===sp||"not_found"===sp?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.XCircle,{className:"h-5 w-5 text-red-500"}),"not_found"===sp?"Image Not Found":"Inspection Failed"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Loader2,{className:"h-5 w-5 animate-spin"}),"pulling"===sp?"Pulling Image...":"Inspecting Image..."]})})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0",children:[sj.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(c.Label,{className:"mb-2 block text-sm",children:"Progress"}),(0,s.jsx)(p.ScrollArea,{className:"h-32 border rounded-lg bg-black/90 p-3",children:(0,s.jsx)("div",{ref:sC,className:"font-mono text-xs text-green-400 space-y-0.5",children:sj.map((e,t)=>(0,s.jsx)("div",{className:"whitespace-pre-wrap break-all",children:e},t))})})]}),sf&&"complete"===sp&&(0,s.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,s.jsx)(c.Label,{className:"block text-sm font-semibold",children:"Discovered Configuration"}),sf.exposed_ports&&sf.exposed_ports.length>0&&(0,s.jsxs)("div",{className:"p-3 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(j.Network,{className:"h-4 w-4 text-accent"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:["Exposed Ports (",sf.exposed_ports.length,")"]})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:sf.exposed_ports.map((e,t)=>(0,s.jsxs)("span",{className:"px-2 py-1 bg-accent/20 rounded text-xs font-mono",children:[e.port,"/",e.protocol]},t))})]}),sf.volumes&&sf.volumes.length>0&&(0,s.jsxs)("div",{className:"p-3 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(E.HardDrive,{className:"h-4 w-4 text-accent"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:["Required Volumes (",sf.volumes.length,")"]})]}),(0,s.jsx)("div",{className:"space-y-1",children:sf.volumes.map((e,t)=>(0,s.jsx)("div",{className:"text-xs font-mono text-muted-foreground",children:e},t))})]}),sf.environment&&sf.environment.filter(e=>e.has_value&&!["PATH","HOME","HOSTNAME"].includes(e.key)).length>0&&(0,s.jsxs)("div",{className:"p-3 bg-muted/50 rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(B.Settings,{className:"h-4 w-4 text-accent flex-shrink-0"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:["Environment Variables (",sf.environment.filter(e=>e.has_value&&!["PATH","HOME","HOSTNAME"].includes(e.key)).length,")"]})]}),(0,s.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto overflow-x-hidden",children:sf.environment.filter(e=>e.has_value&&!["PATH","HOME","HOSTNAME","TERM","LANG","LC_ALL"].includes(e.key)&&!e.key.startsWith("GPG_")).map((e,t)=>(0,s.jsxs)("div",{className:"text-xs font-mono flex items-start gap-0 min-w-0",children:[(0,s.jsx)("span",{className:"text-primary flex-shrink-0",children:e.key}),(0,s.jsx)("span",{className:"text-muted-foreground flex-shrink-0",children:"="}),(0,s.jsx)("span",{className:"text-muted-foreground break-all",children:e.value.length>40?e.value.substring(0,40)+"...":e.value})]},t))})]}),sf.working_dir&&(0,s.jsx)("div",{className:"p-3 bg-muted/50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(R.Terminal,{className:"h-4 w-4 text-accent"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Working Directory:"}),(0,s.jsx)("span",{className:"text-xs font-mono text-muted-foreground",children:sf.working_dir})]})}),(!sf.exposed_ports||0===sf.exposed_ports.length)&&(!sf.volumes||0===sf.volumes.length)&&(!sf.environment||0===sf.environment.filter(e=>e.has_value).length)&&(0,s.jsx)("div",{className:"p-3 bg-muted/50 rounded-lg text-center text-muted-foreground text-sm",children:"No specific configuration hints found in this image."})]}),"not_found"===sp&&(0,s.jsx)("div",{className:"mt-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg text-center",children:(0,s.jsx)("p",{className:"text-sm text-destructive",children:'Image not found locally. Click "Pull & Inspect" to download it.'})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-4 flex-shrink-0",children:["complete"===sp&&sf&&(0,s.jsxs)(o.Button,{onClick:()=>{if(!sf)return;if(sf.exposed_ports&&sf.exposed_ports.length>0){let e=sf.exposed_ports.map(e=>({hostPort:String(e.port),containerPort:String(e.port),protocol:e.protocol||"tcp"}));ex(s=>{let t=new Set(s.map(e=>"".concat(e.containerPort,"/").concat(e.protocol)));return[...s,...e.filter(e=>!t.has("".concat(e.containerPort,"/").concat(e.protocol)))]})}if(sf.volumes&&sf.volumes.length>0){let e=J||X.replace(/[^a-zA-Z0-9-_]/g,"-"),s=sf.volumes.map(s=>{let t=s.split("/").filter(Boolean).pop()||"data";return{type:"volume",hostPath:"",volumeName:"".concat(e,"-").concat(t).toLowerCase().replace(/[^a-z0-9-_]/g,"-"),containerPath:s,readOnly:!1}});eg(e=>{let t=new Set(e.map(e=>e.containerPath));return[...e,...s.filter(e=>!t.has(e.containerPath))]})}let e=new Set(["PATH","HOME","HOSTNAME","TERM","LANG","LC_ALL"]);if(sf.environment&&sf.environment.length>0){let s=sf.environment.filter(s=>s.has_value&&!e.has(s.key)&&!s.key.startsWith("GPG_")).map(e=>({key:e.key,value:e.value}));eI(e=>{let t=new Set(e.map(e=>e.key));return[...e,...s.filter(e=>!t.has(e.key))]})}sf.working_dir&&!eM&&eF(sf.working_dir),sf.user&&!eR&&ez(sf.user),sh(!1)},children:[(0,s.jsx)(V.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Apply Configuration"]}),!su&&(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>sh(!1),children:"complete"===sp?"Skip":"Close"})]})]})})]})}function W(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)(n.DashboardLayout,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(F.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}),children:(0,s.jsx)(U,{})})}}]);