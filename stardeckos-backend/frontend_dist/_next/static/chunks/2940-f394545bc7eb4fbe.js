"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2940],{6707:(e,t,r)=>{r.d(t,{A:()=>l,AuthProvider:()=>i});var o=r(95155),a=r(12115),n=r(20063);let s=(0,a.createContext)(void 0),c="/api";function i(e){let{children:t}=e,[r,i]=(0,a.useState)(null),[l,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(!0),m=(0,n.useRouter)(),g=(0,a.useCallback)(()=>{i(null),u(null),localStorage.removeItem("stardeck-token"),localStorage.removeItem("stardeck-user")},[]),f=(0,a.useCallback)(async e=>{try{let t=await fetch("".concat(c,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)return void g();let r=await t.json();i(r.user)}catch(e){console.warn("Could not validate session with server")}},[g]);(0,a.useEffect)(()=>{let e=localStorage.getItem("stardeck-token"),t=localStorage.getItem("stardeck-user");e&&t&&(u(e),i(JSON.parse(t)),f(e)),h(!1)},[f]);let k=async(e,t,r)=>{try{let o=await fetch("".concat(c,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,auth_type:r||""})});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error||"Login failed")}let a=await o.json();return i(a.user),u(a.token),localStorage.setItem("stardeck-token",a.token),localStorage.setItem("stardeck-user",JSON.stringify(a.user)),!0}catch(e){throw console.error("Login error:",e),e}},y=async()=>{try{l&&await fetch("".concat(c,"/auth/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(l)}})}catch(e){}finally{g(),m.push("/login")}};return(0,o.jsx)(s.Provider,{value:{user:r,token:l,login:k,logout:y,isAuthenticated:!!r&&!!l,isLoading:d},children:t})}function l(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},26198:(e,t,r)=>{r.d(t,{SettingsProvider:()=>f,t:()=>k});var o=r(95155),a=r(12115),n=r(88104);let s="/api",c={cyan:{light:"oklch(0.7889 0.1105 196.6173)",dark:"oklch(0.7000 0.1190 200.4390)",lightForeground:"oklch(0.1496 0 0)",darkForeground:"oklch(0.1290 0.0714 263.7567)"},amber:{light:"oklch(0.7500 0.1500 65.0000)",dark:"oklch(0.7500 0.1500 65.0000)",lightForeground:"oklch(0.1496 0 0)",darkForeground:"oklch(0.1290 0.0714 263.7567)"},green:{light:"oklch(0.7200 0.1500 145.0000)",dark:"oklch(0.6800 0.1500 145.0000)",lightForeground:"oklch(0.1496 0 0)",darkForeground:"oklch(0.1290 0.0714 263.7567)"},purple:{light:"oklch(0.6500 0.1500 300.0000)",dark:"oklch(0.6800 0.1500 300.0000)",lightForeground:"oklch(0.9791 0 0)",darkForeground:"oklch(0.9791 0 0)"},red:{light:"oklch(0.6500 0.2000 25.0000)",dark:"oklch(0.6500 0.2000 25.0000)",lightForeground:"oklch(0.9791 0 0)",darkForeground:"oklch(0.9791 0 0)"}},i={taskbarPosition:"top",tray:{showCpu:!0,showMemory:!0,showDisk:!0,showNetwork:!0,refreshInterval:3},theme:{accentColor:"cyan",enableScanlines:!1,enableGlow:!0,enableAnimations:!0,activeCustomThemeId:null},desktop:{iconSize:"medium",showLabels:!0,gridSpacing:"normal",coloredIcons:!0,backgroundType:"default",backgroundColor:"#1a1a2e",backgroundGradient:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",backgroundImage:""},container:{defaultRestartPolicy:"unless-stopped",defaultNetworkMode:"bridge",autoStartContainers:!0,enablePrivilegedByDefault:!1}},l=(0,a.createContext)(void 0),u="stardeck-settings",d="stardeck-custom-themes";function h(){return localStorage.getItem("stardeck-token")}async function m(){let e=h();if(!e)return null;try{let t=await fetch("".concat(s,"/user/preferences"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)return null;let r=await t.json();if(r.preferences)return{settings:r.preferences.settings,customThemes:r.preferences.customThemes};return null}catch(e){return console.warn("Failed to fetch preferences from API"),null}}async function g(e,t){let r=h();if(!r)return!1;try{return(await fetch("".concat(s,"/user/preferences"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({preferences:{settings:e,customThemes:t}})})).ok}catch(e){return console.warn("Failed to save preferences to API"),!1}}function f(e){let{children:t}=e,[r,s]=(0,a.useState)(i),[h,f]=(0,a.useState)([]),[k,y]=(0,a.useState)(!1),[p,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem(u);if(e){let t=JSON.parse(e);t.theme&&void 0===t.theme.activeCustomThemeId&&(t.theme.activeCustomThemeId=null),t.container||(t.container=i.container),s({...i,...t})}let t=localStorage.getItem(d);if(t){let e=JSON.parse(t);f(e)}}catch(e){console.error("Failed to load settings from localStorage:",e)}let e=await m();e&&(e.settings&&(s(t=>({...t,...e.settings})),localStorage.setItem(u,JSON.stringify(e.settings))),e.customThemes&&e.customThemes.length>0&&(f(e.customThemes),localStorage.setItem(d,JSON.stringify(e.customThemes)))),y(!0)})()},[]);let v=(0,a.useCallback)(async(e,t)=>{p||(b(!0),await g(e,t),b(!1))},[p]);(0,a.useEffect)(()=>{if(k)try{localStorage.setItem(u,JSON.stringify(r));let e=setTimeout(()=>{v(r,h)},500);return()=>clearTimeout(e)}catch(e){console.error("Failed to save settings:",e)}},[r,k,h,v]),(0,a.useEffect)(()=>{if(k)try{localStorage.setItem(d,JSON.stringify(h));let e=setTimeout(()=>{v(r,h)},500);return()=>clearTimeout(e)}catch(e){console.error("Failed to save custom themes:",e)}},[h,k,r,v]),(0,a.useEffect)(()=>{if(!k)return;let e=document.documentElement,t=e.classList.contains("dark"),o=r.theme.activeCustomThemeId?h.find(e=>e.id===r.theme.activeCustomThemeId):null;if(o){let e=t?o.darkVariables:o.lightVariables,r=Object.keys(e).length>0?e:o.lightVariables;(0,n.Hb)(r,t)}else{(0,n.Ix)((0,n.FY)());let o=c[r.theme.accentColor];e.style.setProperty("--accent",t?o.dark:o.light),e.style.setProperty("--accent-foreground",t?o.darkForeground:o.lightForeground),e.style.setProperty("--ring",t?o.dark:o.light)}},[r.theme.accentColor,r.theme.activeCustomThemeId,h,k]),(0,a.useEffect)(()=>{if(!k)return;let e=new MutationObserver(e=>{e.forEach(e=>{if("attributes"===e.type&&"class"===e.attributeName){let e=document.documentElement,t=e.classList.contains("dark"),o=r.theme.activeCustomThemeId?h.find(e=>e.id===r.theme.activeCustomThemeId):null;if(o){let e=t?o.darkVariables:o.lightVariables,r=Object.keys(e).length>0?e:o.lightVariables;(0,n.Hb)(r,t)}else{let o=c[r.theme.accentColor];e.style.setProperty("--accent",t?o.dark:o.light),e.style.setProperty("--accent-foreground",t?o.darkForeground:o.lightForeground),e.style.setProperty("--ring",t?o.dark:o.light)}}})});return e.observe(document.documentElement,{attributes:!0}),()=>e.disconnect()},[r.theme.accentColor,r.theme.activeCustomThemeId,h,k]);let S=e=>{s(t=>({...t,theme:{...t.theme,...e}}))};return(0,o.jsx)(l.Provider,{value:{settings:r,updateSettings:e=>{s(t=>({...t,...e}))},updateTraySettings:e=>{s(t=>({...t,tray:{...t.tray,...e}}))},updateThemeSettings:S,updateDesktopSettings:e=>{s(t=>({...t,desktop:{...t.desktop,...e}}))},updateContainerSettings:e=>{s(t=>({...t,container:{...t.container,...e}}))},resetSettings:()=>{s(i)},customThemes:h,addCustomTheme:e=>{f(t=>[...t,e])},removeCustomTheme:e=>{r.theme.activeCustomThemeId===e&&S({activeCustomThemeId:null}),f(t=>t.filter(t=>t.id!==e))},applyCustomTheme:e=>{S({activeCustomThemeId:e})},getActiveCustomTheme:()=>r.theme.activeCustomThemeId&&h.find(e=>e.id===r.theme.activeCustomThemeId)||null},children:t})}function k(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}},81901:(e,t,r)=>{r.d(t,{D:()=>c,ThemeProvider:()=>s});var o=r(95155),a=r(12115);let n=(0,a.createContext)({theme:"system",setTheme:()=>null});function s(e){let{children:t,defaultTheme:r="dark",storageKey:s="stardeck-ui-theme",...c}=e,[i,l]=(0,a.useState)(r),[u,d]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{d(!0);let e=localStorage.getItem(s);e&&l(e)},[s]),(0,a.useEffect)(()=>{if(!u)return;let e=window.document.documentElement;if(e.classList.remove("light","dark"),"system"===i){let t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e.classList.add(t);return}e.classList.add(i)},[i,u]),u)?(0,o.jsx)(n.Provider,{...c,value:{theme:i,setTheme:e=>{localStorage.setItem(s,e),l(e)}},children:t}):(0,o.jsx)(o.Fragment,{children:t})}let c=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},88104:(e,t,r)=>{function o(e){let t,r={},o=/--([a-zA-Z0-9-]+):\s*([^;]+);/g;for(;null!==(t=o.exec(e));){let e=t[1],o=t[2].trim();r[e]=o}return r}function a(e){let t=function(e){let t=e.match(/:root\s*\{([^}]*(?:\{[^}]*\}[^}]*)*)\}/);return t?t[1]:null}(e),r=function(e){let t=e.match(/\.dark\s*\{([^}]*(?:\{[^}]*\}[^}]*)*)\}/);return t?t[1]:null}(e);return{light:t?o(t):{},dark:r?o(r):{}}}function n(e){let t=[];for(let r of["background","foreground","primary","accent"])e.light[r]||t.push("Missing light theme variable: --".concat(r));return Object.keys(e.dark).length>0||t.push("Warning: No dark theme variables found. Light theme will be used for both modes."),{isValid:0===t.filter(e=>!e.startsWith("Warning")).length,errors:t}}function s(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=document.documentElement;for(let[r,o]of Object.entries(e))void 0!==o&&t.style.setProperty("--".concat(r),o)}function c(e){let t=document.documentElement;for(let r of e)t.style.removeProperty("--".concat(r))}function i(){return["background","foreground","card","card-foreground","popover","popover-foreground","primary","primary-foreground","secondary","secondary-foreground","muted","muted-foreground","accent","accent-foreground","destructive","destructive-foreground","border","input","ring","chart-1","chart-2","chart-3","chart-4","chart-5","sidebar","sidebar-foreground","sidebar-primary","sidebar-primary-foreground","sidebar-accent","sidebar-accent-foreground","sidebar-border","sidebar-ring","font-sans","font-serif","font-mono","radius","spacing","tracking-normal","shadow-2xs","shadow-xs","shadow-sm","shadow","shadow-md","shadow-lg","shadow-xl","shadow-2xl"]}function l(e,t,r){return{id:"theme_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),name:e,createdAt:new Date().toISOString(),lightVariables:r.light,darkVariables:r.dark,rawCss:t}}function u(e){let t=":root {\n";for(let[r,o]of Object.entries(e.lightVariables))void 0!==o&&(t+="  --".concat(r,": ").concat(o,";\n"));for(let[r,o]of(t+="}\n\n.dark {\n",Object.entries(e.darkVariables)))void 0!==o&&(t+="  --".concat(r,": ").concat(o,";\n"));return t+"}\n"}r.d(t,{Ef:()=>n,FY:()=>i,Hb:()=>s,Ix:()=>c,eY:()=>u,pf:()=>l,qw:()=>a})}}]);