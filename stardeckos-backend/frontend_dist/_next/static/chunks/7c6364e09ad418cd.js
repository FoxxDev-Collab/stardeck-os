(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27341,e=>{"use strict";e.s(["Tabs",()=>I,"TabsContent",()=>B,"TabsList",()=>z,"TabsTrigger",()=>P],27341);var t=e.i(43476),s=e.i(71645),a=e.i(81140),r=e.i(30030),n=e.i(42727),l=e.i(96626);e.i(74080);var i=e.i(20783),c=Symbol("radix.slottable");function o(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===c}var d=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let r=function(e){let a=function(e){let t=s.forwardRef((e,t)=>{let{children:a,...r}=e;if(s.isValidElement(a)){var n,l,c;let e,o,d=(o=(e=null==(l=Object.getOwnPropertyDescriptor((n=a).props,"ref"))?void 0:l.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(o=(e=null==(c=Object.getOwnPropertyDescriptor(n,"ref"))?void 0:c.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref,h=function(e,t){let s={...t};for(let a in t){let r=e[a],n=t[a];/^on[A-Z]/.test(a)?r&&n?s[a]=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let a=n(...t);return r(...t),a}:r&&(s[a]=r):"style"===a?s[a]={...r,...n}:"className"===a&&(s[a]=[r,n].filter(Boolean).join(" "))}return{...e,...s}}(r,a.props);return a.type!==s.Fragment&&(h.ref=t?(0,i.composeRefs)(t,d):d),s.cloneElement(a,h)}return s.Children.count(a)>1?s.Children.only(null):null});return t.displayName="".concat(e,".SlotClone"),t}(e),r=s.forwardRef((e,r)=>{let{children:n,...l}=e,i=s.Children.toArray(n),c=i.find(o);if(c){let e=c.props.children,n=i.map(t=>t!==c?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,t.jsx)(a,{...l,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,t.jsx)(a,{...l,ref:r,children:n})});return r.displayName="".concat(e,".Slot"),r}("Primitive.".concat(a)),n=s.forwardRef((e,s)=>{let{asChild:n,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?r:a,{...l,ref:s})});return n.displayName="Primitive.".concat(a),{...e,[a]:n}},{}),h=e.i(86318),x=e.i(69340),u=e.i(10772),m="Tabs",[p,j]=(0,r.createContextScope)(m,[n.createRovingFocusGroupScope]),f=(0,n.createRovingFocusGroupScope)(),[g,v]=p(m),b=s.forwardRef((e,s)=>{let{__scopeTabs:a,value:r,onValueChange:n,defaultValue:l,orientation:i="horizontal",dir:c,activationMode:o="automatic",...p}=e,j=(0,h.useDirection)(c),[f,v]=(0,x.useControllableState)({prop:r,onChange:n,defaultProp:null!=l?l:"",caller:m});return(0,t.jsx)(g,{scope:a,baseId:(0,u.useId)(),value:f,onValueChange:v,orientation:i,dir:j,activationMode:o,children:(0,t.jsx)(d.div,{dir:j,"data-orientation":i,...p,ref:s})})});b.displayName=m;var N="TabsList",w=s.forwardRef((e,s)=>{let{__scopeTabs:a,loop:r=!0,...l}=e,i=v(N,a),c=f(a);return(0,t.jsx)(n.Root,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:r,children:(0,t.jsx)(d.div,{role:"tablist","aria-orientation":i.orientation,...l,ref:s})})});w.displayName=N;var y="TabsTrigger",C=s.forwardRef((e,s)=>{let{__scopeTabs:r,value:l,disabled:i=!1,...c}=e,o=v(y,r),h=f(r),x=T(o.baseId,l),u=A(o.baseId,l),m=l===o.value;return(0,t.jsx)(n.Item,{asChild:!0,...h,focusable:!i,active:m,children:(0,t.jsx)(d.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":u,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:x,...c,ref:s,onMouseDown:(0,a.composeEventHandlers)(e.onMouseDown,e=>{i||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(l)}),onKeyDown:(0,a.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(l)}),onFocus:(0,a.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==o.activationMode;m||i||!e||o.onValueChange(l)})})})});C.displayName=y;var k="TabsContent",S=s.forwardRef((e,a)=>{let{__scopeTabs:r,value:n,forceMount:i,children:c,...o}=e,h=v(k,r),x=T(h.baseId,n),u=A(h.baseId,n),m=n===h.value,p=s.useRef(m);return s.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(l.Presence,{present:i||m,children:s=>{let{present:r}=s;return(0,t.jsx)(d.div,{"data-state":m?"active":"inactive","data-orientation":h.orientation,role:"tabpanel","aria-labelledby":x,hidden:!r,id:u,tabIndex:0,...o,ref:a,style:{...e.style,animationDuration:p.current?"0s":void 0},children:r&&c})}})});function T(e,t){return"".concat(e,"-trigger-").concat(t)}function A(e,t){return"".concat(e,"-content-").concat(t)}S.displayName=k;var D=e.i(47163);function I(e){let{className:s,...a}=e;return(0,t.jsx)(b,{"data-slot":"tabs",className:(0,D.cn)("flex flex-col gap-2",s),...a})}function z(e){let{className:s,...a}=e;return(0,t.jsx)(w,{"data-slot":"tabs-list",className:(0,D.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...a})}function P(e){let{className:s,...a}=e;return(0,t.jsx)(C,{"data-slot":"tabs-trigger",className:(0,D.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}function B(e){let{className:s,...a}=e;return(0,t.jsx)(S,{"data-slot":"tabs-content",className:(0,D.cn)("flex-1 outline-none",s),...a})}},43531,e=>{"use strict";e.s(["Check",()=>t.default]);var t=e.i(78745)},7233,e=>{"use strict";e.s(["Plus",()=>t],7233);let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},17566,e=>{"use strict";e.s(["default",()=>R],17566);var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(91432),n=e.i(70065),l=e.i(67881),i=e.i(23750),c=e.i(10708),o=e.i(27341),d=e.i(25913),h=e.i(47163);let x=(0,d.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,h.cn)(x({variant:a}),s),...r})}var m=e.i(30374),p=e.i(62870),j=e.i(30009),f=e.i(48654),g=e.i(21218),v=e.i(78094),b=e.i(98919),N=e.i(75254);let w=(0,N.default)("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),y=(0,N.default)("cable",[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]]);var C=e.i(16715),k=e.i(7233),S=e.i(27612),T=e.i(43531),A=e.i(37727);let D=(0,N.default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var I=e.i(48256),z=e.i(18393),P=e.i(53475),B=e.i(78894);function R(){let{isAuthenticated:e,isLoading:d,token:h,user:x}=(0,r.useAuth)(),N=(0,a.useRouter)(),[R,E]=(0,s.useState)(""),[F,M]=(0,s.useState)("interfaces"),[V,L]=(0,s.useState)([]),[H,O]=(0,s.useState)({}),[_,G]=(0,s.useState)(null),[U,W]=(0,s.useState)([]),[K,X]=(0,s.useState)([]),[q,J]=(0,s.useState)([]),[Z,Q]=(0,s.useState)(null),[Y,$]=(0,s.useState)([]),[ee,et]=(0,s.useState)(null),[es,ea]=(0,s.useState)(!1),[er,en]=(0,s.useState)(!1),[el,ei]=(0,s.useState)(!1),[ec,eo]=(0,s.useState)(!1),[ed,eh]=(0,s.useState)(!1),[ex,eu]=(0,s.useState)(!1),[em,ep]=(0,s.useState)({success:!1,message:""}),[ej,ef]=(0,s.useState)(null),[eg,ev]=(0,s.useState)(""),[eb,eN]=(0,s.useState)({port:"",protocol:"tcp"}),[ew,ey]=(0,s.useState)({destination:"",gateway:"",interface:"",metric:0}),[eC,ek]=(0,s.useState)({type:"",zone:"",value:""}),[eS,eT]=(0,s.useState)({protocol:"",state:""}),eA=(null==x?void 0:x.role)==="admin",eD=(0,s.useCallback)(async()=>{if(h)try{let e=await fetch("/api/network/interfaces",{headers:{Authorization:"Bearer ".concat(h)}});if(e.ok){let t=await e.json();L(t||[]);let s=(t||[]).map(async e=>{let t=await fetch("/api/network/interfaces/".concat(e.name,"/stats"),{headers:{Authorization:"Bearer ".concat(h)}});return t.ok?{name:e.name,stats:await t.json()}:null}),a=await Promise.all(s),r={};a.forEach(e=>{e&&(r[e.name]=e.stats)}),O(r)}}catch(e){console.error("Failed to fetch interfaces:",e)}},[h]),eI=(0,s.useCallback)(async()=>{if(h)try{let[e,t,s]=await Promise.all([fetch("/api/network/firewall/status",{headers:{Authorization:"Bearer ".concat(h)}}),fetch("/api/network/firewall/zones",{headers:{Authorization:"Bearer ".concat(h)}}),fetch("/api/network/firewall/services",{headers:{Authorization:"Bearer ".concat(h)}})]);e.ok&&G(await e.json()),t.ok&&W(await t.json()),s.ok&&X(await s.json())}catch(e){console.error("Failed to fetch firewall data:",e)}},[h]),ez=(0,s.useCallback)(async()=>{if(h)try{let[e,t]=await Promise.all([fetch("/api/network/routes",{headers:{Authorization:"Bearer ".concat(h)}}),fetch("/api/network/dns",{headers:{Authorization:"Bearer ".concat(h)}})]);e.ok&&J(await e.json()),t.ok&&Q(await t.json())}catch(e){console.error("Failed to fetch routes:",e)}},[h]),eP=(0,s.useCallback)(async()=>{if(h)try{let e=new URLSearchParams;eS.protocol&&e.append("protocol",eS.protocol),eS.state&&e.append("state",eS.state);let t=await fetch("/api/network/connections?".concat(e),{headers:{Authorization:"Bearer ".concat(h)}});t.ok&&$(await t.json())}catch(e){console.error("Failed to fetch connections:",e)}},[h,eS]),eB=(0,s.useCallback)(async()=>{ea(!0),et(null);try{await Promise.all([eD(),eI(),ez(),eP()])}catch(e){et(e instanceof Error?e.message:"Failed to fetch network data")}finally{ea(!1)}},[eD,eI,ez,eP]);(0,s.useEffect)(()=>{d||e||N.push("/login")},[e,d,N]),(0,s.useEffect)(()=>{let e=()=>{E(new Date().toLocaleTimeString("en-US",{hour12:!1}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[]),(0,s.useEffect)(()=>{if(e&&h){eB();let e=setInterval(eB,3e4);return()=>clearInterval(e)}},[e,h,eB]),(0,s.useEffect)(()=>{e&&h&&eP()},[eS,e,h,eP]);let eR=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,t)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][t])},eE=async()=>{if(ej&&eg&&h)try{let e=await fetch("/api/network/firewall/zones/".concat(ej.name,"/services"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)},body:JSON.stringify({service:eg,permanent:!0})}),t=await e.json();ep({success:e.ok,message:e.ok?"Service added successfully":t.error||"Failed to add service"}),eu(!0),en(!1),e.ok&&eI()}catch(e){ep({success:!1,message:"Failed to add service"}),eu(!0)}},eF=async()=>{if(ej&&eb.port&&h)try{let e=await fetch("/api/network/firewall/zones/".concat(ej.name,"/ports"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)},body:JSON.stringify({port:parseInt(eb.port),protocol:eb.protocol,permanent:!0})}),t=await e.json();ep({success:e.ok,message:e.ok?"Port added successfully":t.error||"Failed to add port"}),eu(!0),ei(!1),e.ok&&eI()}catch(e){ep({success:!1,message:"Failed to add port"}),eu(!0)}},eM=async()=>{if(ew.destination&&h)try{let e=await fetch("/api/network/routes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)},body:JSON.stringify(ew)}),t=await e.json();ep({success:e.ok,message:e.ok?"Route added successfully":t.error||"Failed to add route"}),eu(!0),eo(!1),e.ok&&ez()}catch(e){ep({success:!1,message:"Failed to add route"}),eu(!0)}},eV=async()=>{if(h)try{let e;if("service"===eC.type?e=await fetch("/api/network/firewall/zones/".concat(eC.zone,"/services/").concat(eC.value,"?permanent=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(h)}}):"port"===eC.type?e=await fetch("/api/network/firewall/zones/".concat(eC.zone,"/ports/").concat(eC.value,"?permanent=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(h)}}):"route"===eC.type&&(e=await fetch("/api/network/routes/".concat(encodeURIComponent(eC.value)),{method:"DELETE",headers:{Authorization:"Bearer ".concat(h)}})),e){let t=await e.json();ep({success:e.ok,message:e.ok?"Deleted successfully":t.error||"Failed to delete"}),eu(!0),eh(!1),e.ok&&("route"===eC.type?ez():eI())}}catch(e){ep({success:!1,message:"Failed to delete"}),eu(!0)}},eL=async()=>{if(h)try{let e=await fetch("/api/network/firewall/reload",{method:"POST",headers:{Authorization:"Bearer ".concat(h)}}),t=await e.json();ep({success:e.ok,message:e.ok?"Firewall reloaded":t.error||"Failed to reload"}),eu(!0),e.ok&&eI()}catch(e){ep({success:!1,message:"Failed to reload firewall"}),eu(!0)}};return d||!e?(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsx)(g.Activity,{className:"w-12 h-12 text-accent animate-pulse"})}):(0,t.jsxs)(f.DashboardLayout,{title:"NETWORK MANAGER",time:R,children:[(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Interfaces"}),(0,t.jsx)(v.Network,{className:"w-4 h-4 text-accent"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:V.length}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[V.filter(e=>"up"===e.state).length," active"]})]})]}),(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Firewall"}),(0,t.jsx)(b.Shield,{className:"w-4 h-4 text-chart-3"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsxs)("div",{className:"text-3xl font-bold flex items-center gap-2",children:[(null==_?void 0:_.running)?(0,t.jsx)(T.Check,{className:"w-6 h-6 text-green-500"}):(0,t.jsx)(A.X,{className:"w-6 h-6 text-destructive"}),(null==_?void 0:_.running)?"Active":"Inactive"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Default: ",(null==_?void 0:_.default_zone)||"N/A"]})]})]}),(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Routes"}),(0,t.jsx)(w,{className:"w-4 h-4 text-chart-4"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:q.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"routing entries"})]})]}),(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),(0,t.jsx)(D,{className:"w-4 h-4 text-chart-5"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:Y.length}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[Y.filter(e=>"ESTAB"===e.state).length," established"]})]})]})]}),ee&&(0,t.jsx)("div",{className:"p-4 rounded-lg border border-destructive/50 bg-destructive/10 text-destructive",children:ee}),(0,t.jsxs)(o.Tabs,{value:F,onValueChange:M,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)(o.TabsList,{children:[(0,t.jsxs)(o.TabsTrigger,{value:"interfaces",className:"gap-2",children:[(0,t.jsx)(v.Network,{className:"w-4 h-4"}),"Interfaces"]}),(0,t.jsxs)(o.TabsTrigger,{value:"firewall",className:"gap-2",children:[(0,t.jsx)(b.Shield,{className:"w-4 h-4"}),"Firewall"]}),(0,t.jsxs)(o.TabsTrigger,{value:"routes",className:"gap-2",children:[(0,t.jsx)(w,{className:"w-4 h-4"}),"Routes"]}),(0,t.jsxs)(o.TabsTrigger,{value:"connections",className:"gap-2",children:[(0,t.jsx)(D,{className:"w-4 h-4"}),"Connections"]})]}),(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:eB,disabled:es,children:(0,t.jsx)(C.RefreshCw,{className:"w-4 h-4 ".concat(es?"animate-spin":"")})})]}),(0,t.jsx)(o.TabsContent,{value:"interfaces",children:(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Network,{className:"w-5 h-5 text-accent"}),"Network Interfaces"]})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:V.map(e=>(0,t.jsx)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40",children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(e=>{switch(e){case"loopback":return(0,t.jsx)(z.Server,{className:"w-4 h-4"});case"wireless":return(0,t.jsx)(P.Wifi,{className:"w-4 h-4"});case"bridge":case"virtual":return(0,t.jsx)(v.Network,{className:"w-4 h-4"});default:return(0,t.jsx)(y,{className:"w-4 h-4"})}})(e.type),(0,t.jsx)("h3",{className:"font-semibold font-mono",children:e.name}),(0,t.jsx)(u,{variant:"up"===e.state?"default":"secondary",children:e.state}),(0,t.jsx)(u,{variant:"outline",children:e.type}),e.is_physical&&(0,t.jsx)(u,{variant:"outline",children:"Physical"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"MAC:"}),(0,t.jsx)("span",{className:"ml-2 font-mono",children:e.mac||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"MTU:"}),(0,t.jsx)("span",{className:"ml-2",children:e.mtu})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Speed:"}),(0,t.jsx)("span",{className:"ml-2",children:e.speed>0?"".concat(e.speed," Mbps"):"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Driver:"}),(0,t.jsx)("span",{className:"ml-2",children:e.driver||"N/A"})]})]}),(e.ipv4.length>0||e.ipv6.length>0)&&(0,t.jsxs)("div",{className:"mt-3 space-y-1",children:[e.ipv4.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(I.Globe,{className:"w-3 h-3 text-muted-foreground"}),(0,t.jsx)("span",{className:"font-mono text-accent",children:e}),(0,t.jsx)(u,{variant:"outline",className:"text-xs",children:"IPv4"})]},s)),e.ipv6.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(I.Globe,{className:"w-3 h-3 text-muted-foreground"}),(0,t.jsx)("span",{className:"font-mono text-xs",children:e}),(0,t.jsx)(u,{variant:"outline",className:"text-xs",children:"IPv6"})]},s))]}),H[e.name]&&(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-muted-foreground",children:[(0,t.jsxs)("div",{children:["RX: ",eR(H[e.name].rx_bytes)]}),(0,t.jsxs)("div",{children:["TX: ",eR(H[e.name].tx_bytes)]}),(0,t.jsxs)("div",{children:["Packets RX: ",H[e.name].rx_packets]}),(0,t.jsxs)("div",{children:["Packets TX: ",H[e.name].tx_packets]})]})]})})},e.name))})})]})}),(0,t.jsx)(o.TabsContent,{value:"firewall",children:(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Shield,{className:"w-5 h-5 text-chart-3"}),"Firewall Zones"]}),eA&&(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:eL,children:[(0,t.jsx)(C.RefreshCw,{className:"w-4 h-4 mr-2"}),"Reload Firewall"]})]}),(0,t.jsx)(n.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:U.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.name}),e.is_default&&(0,t.jsx)(u,{children:"Default"}),e.is_active&&(0,t.jsx)(u,{variant:"outline",className:"text-green-500 border-green-500",children:"Active"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Target: ",e.target||"default"]})]}),eA&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{ef(e),ev(""),en(!0)},children:[(0,t.jsx)(k.Plus,{className:"w-4 h-4 mr-1"}),"Service"]}),(0,t.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{ef(e),eN({port:"",protocol:"tcp"}),ei(!0)},children:[(0,t.jsx)(k.Plus,{className:"w-4 h-4 mr-1"}),"Port"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[e.interfaces.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Interfaces:"}),e.interfaces.map(e=>(0,t.jsx)(u,{variant:"secondary",children:e},e))]}),e.services.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Services:"}),e.services.map(s=>(0,t.jsxs)(u,{variant:"outline",className:"gap-1 cursor-pointer hover:bg-destructive/10",onClick:()=>{eA&&(ek({type:"service",zone:e.name,value:s}),eh(!0))},children:[s,eA&&(0,t.jsx)(A.X,{className:"w-3 h-3"})]},s))]}),e.ports.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Ports:"}),e.ports.map(s=>(0,t.jsxs)(u,{variant:"outline",className:"gap-1 cursor-pointer hover:bg-destructive/10",onClick:()=>{eA&&(ek({type:"port",zone:e.name,value:s}),eh(!0))},children:[s,eA&&(0,t.jsx)(A.X,{className:"w-3 h-3"})]},s))]}),e.masquerade&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsx)(T.Check,{className:"w-4 h-4 inline mr-1 text-green-500"}),"Masquerading enabled"]})]})]},e.name))})})]})}),(0,t.jsx)(o.TabsContent,{value:"routes",children:(0,t.jsxs)("div",{className:"space-y-6",children:[Z&&(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(I.Globe,{className:"w-5 h-5 text-chart-4"}),"DNS Configuration"]})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"Hostname"}),(0,t.jsx)("p",{className:"font-mono",children:Z.hostname})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"FQDN"}),(0,t.jsx)("p",{className:"font-mono",children:Z.fqdn||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"Nameservers"}),(0,t.jsx)("div",{className:"space-y-1",children:Z.nameservers.map((e,s)=>(0,t.jsx)("p",{className:"font-mono text-sm",children:e},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{className:"text-muted-foreground",children:"Search Domains"}),(0,t.jsx)("div",{className:"space-y-1",children:Z.search.map((e,s)=>(0,t.jsx)("p",{className:"font-mono text-sm",children:e},s))})]})]})})]}),(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(w,{className:"w-5 h-5 text-chart-4"}),"Routing Table"]}),eA&&(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>{ey({destination:"",gateway:"",interface:"",metric:0}),eo(!0)},children:[(0,t.jsx)(k.Plus,{className:"w-4 h-4 mr-2"}),"Add Route"]})]}),(0,t.jsx)(n.CardContent,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border/50",children:[(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Destination"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Gateway"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Interface"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Metric"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Protocol"}),eA&&(0,t.jsx)("th",{className:"text-right p-2 text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:q.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b border-border/30 hover:bg-muted/20",children:[(0,t.jsx)("td",{className:"p-2 font-mono",children:e.destination}),(0,t.jsx)("td",{className:"p-2 font-mono",children:e.gateway||"-"}),(0,t.jsx)("td",{className:"p-2",children:e.interface}),(0,t.jsx)("td",{className:"p-2",children:e.metric}),(0,t.jsx)("td",{className:"p-2",children:e.protocol}),eA&&(0,t.jsx)("td",{className:"p-2 text-right",children:(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{ek({type:"route",zone:"",value:e.destination}),eh(!0)},children:(0,t.jsx)(S.Trash2,{className:"w-4 h-4 text-destructive"})})})]},s))})]})})})]})]})}),(0,t.jsx)(o.TabsContent,{value:"connections",children:(0,t.jsxs)(n.Card,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(D,{className:"w-5 h-5 text-chart-5"}),"Active Connections"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(p.Select,{value:eS.protocol,onValueChange:e=>eT(t=>({...t,protocol:e})),children:[(0,t.jsx)(p.SelectTrigger,{className:"w-32",children:(0,t.jsx)(p.SelectValue,{placeholder:"Protocol"})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(p.SelectItem,{value:"tcp",children:"TCP"}),(0,t.jsx)(p.SelectItem,{value:"udp",children:"UDP"})]})]}),(0,t.jsxs)(p.Select,{value:eS.state,onValueChange:e=>eT(t=>({...t,state:e})),children:[(0,t.jsx)(p.SelectTrigger,{className:"w-40",children:(0,t.jsx)(p.SelectValue,{placeholder:"State"})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"all",children:"All States"}),(0,t.jsx)(p.SelectItem,{value:"ESTABLISHED",children:"Established"}),(0,t.jsx)(p.SelectItem,{value:"LISTEN",children:"Listening"}),(0,t.jsx)(p.SelectItem,{value:"TIME-WAIT",children:"Time Wait"})]})]})]})]}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border/50",children:[(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Protocol"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Local Address"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Remote Address"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"State"}),(0,t.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Process"})]})}),(0,t.jsx)("tbody",{children:Y.slice(0,100).map((e,s)=>(0,t.jsxs)("tr",{className:"border-b border-border/30 hover:bg-muted/20",children:[(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)(u,{variant:"outline",children:e.protocol.toUpperCase()})}),(0,t.jsxs)("td",{className:"p-2 font-mono text-xs",children:[e.local_addr,":",e.local_port]}),(0,t.jsxs)("td",{className:"p-2 font-mono text-xs",children:[e.remote_addr,":",e.remote_port]}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)(u,{variant:"ESTAB"===e.state?"default":"secondary",className:"text-xs",children:e.state})}),(0,t.jsx)("td",{className:"p-2 text-xs",children:e.process?"".concat(e.process," (").concat(e.pid,")"):"-"})]},s))})]}),Y.length>100&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:["Showing 100 of ",Y.length," connections"]})]})})]})})]})]}),(0,t.jsx)(m.Dialog,{open:er,onOpenChange:en,children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsxs)(m.DialogTitle,{children:["Add Service to ",null==ej?void 0:ej.name]}),(0,t.jsx)(m.DialogDescription,{children:"Allow a service through the firewall in this zone."})]}),(0,t.jsxs)("div",{className:"py-4",children:[(0,t.jsx)(c.Label,{children:"Service"}),(0,t.jsxs)(p.Select,{value:eg,onValueChange:ev,children:[(0,t.jsx)(p.SelectTrigger,{className:"mt-2",children:(0,t.jsx)(p.SelectValue,{placeholder:"Select a service"})}),(0,t.jsx)(p.SelectContent,{className:"max-h-60",children:K.filter(e=>!(null==ej?void 0:ej.services.includes(e))).map(e=>(0,t.jsx)(p.SelectItem,{value:e,children:e},e))})]})]}),(0,t.jsxs)(m.DialogFooter,{children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>en(!1),children:"Cancel"}),(0,t.jsx)(l.Button,{onClick:eE,disabled:!eg,children:"Add Service"})]})]})}),(0,t.jsx)(m.Dialog,{open:el,onOpenChange:ei,children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsxs)(m.DialogTitle,{children:["Add Port to ",null==ej?void 0:ej.name]}),(0,t.jsx)(m.DialogDescription,{children:"Open a port in this firewall zone."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Port Number"}),(0,t.jsx)(i.Input,{type:"number",min:1,max:65535,placeholder:"e.g., 8080",value:eb.port,onChange:e=>eN(t=>({...t,port:e.target.value})),className:"mt-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Protocol"}),(0,t.jsxs)(p.Select,{value:eb.protocol,onValueChange:e=>eN(t=>({...t,protocol:e})),children:[(0,t.jsx)(p.SelectTrigger,{className:"mt-2",children:(0,t.jsx)(p.SelectValue,{})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"tcp",children:"TCP"}),(0,t.jsx)(p.SelectItem,{value:"udp",children:"UDP"})]})]})]})]}),(0,t.jsxs)(m.DialogFooter,{children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>ei(!1),children:"Cancel"}),(0,t.jsx)(l.Button,{onClick:eF,disabled:!eb.port,children:"Add Port"})]})]})}),(0,t.jsx)(m.Dialog,{open:ec,onOpenChange:eo,children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsx)(m.DialogTitle,{children:"Add Static Route"}),(0,t.jsx)(m.DialogDescription,{children:"Add a new route to the routing table."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Destination (CIDR)"}),(0,t.jsx)(i.Input,{placeholder:"e.g., 10.0.0.0/8",value:ew.destination,onChange:e=>ey(t=>({...t,destination:e.target.value})),className:"mt-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Gateway (optional)"}),(0,t.jsx)(i.Input,{placeholder:"e.g., 192.168.1.1",value:ew.gateway,onChange:e=>ey(t=>({...t,gateway:e.target.value})),className:"mt-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Interface (optional)"}),(0,t.jsxs)(p.Select,{value:ew.interface,onValueChange:e=>ey(t=>({...t,interface:e})),children:[(0,t.jsx)(p.SelectTrigger,{className:"mt-2",children:(0,t.jsx)(p.SelectValue,{placeholder:"Select interface"})}),(0,t.jsx)(p.SelectContent,{children:V.map(e=>(0,t.jsx)(p.SelectItem,{value:e.name,children:e.name},e.name))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{children:"Metric (optional)"}),(0,t.jsx)(i.Input,{type:"number",min:0,placeholder:"0",value:ew.metric||"",onChange:e=>ey(t=>({...t,metric:parseInt(e.target.value)||0})),className:"mt-2"})]})]}),(0,t.jsxs)(m.DialogFooter,{children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>eo(!1),children:"Cancel"}),(0,t.jsx)(l.Button,{onClick:eM,disabled:!ew.destination,children:"Add Route"})]})]})}),(0,t.jsx)(j.AlertDialog,{open:ed,onOpenChange:eh,children:(0,t.jsxs)(j.AlertDialogContent,{children:[(0,t.jsxs)(j.AlertDialogHeader,{children:[(0,t.jsxs)(j.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(B.AlertTriangle,{className:"w-5 h-5 text-destructive"}),"Confirm Deletion"]}),(0,t.jsxs)(j.AlertDialogDescription,{children:["Are you sure you want to delete this ",eC.type,"? This action may affect network connectivity."]})]}),(0,t.jsxs)(j.AlertDialogFooter,{children:[(0,t.jsx)(j.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(j.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:eV,children:"Delete"})]})]})}),(0,t.jsx)(m.Dialog,{open:ex,onOpenChange:eu,children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsx)(m.DialogHeader,{children:(0,t.jsx)(m.DialogTitle,{className:em.success?"text-green-500":"text-destructive",children:em.success?"Success":"Error"})}),(0,t.jsx)("div",{className:"py-4",children:(0,t.jsx)("p",{children:em.message})}),(0,t.jsx)(m.DialogFooter,{children:(0,t.jsx)(l.Button,{onClick:()=>eu(!1),children:"Close"})})]})})]})}}]);